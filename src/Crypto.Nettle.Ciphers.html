<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP, MultiParamTypeClasses, FlexibleInstances, FlexibleContexts #-}</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-4"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-5"></a><span class="hs-comment">-- Module      :  Crypto.Nettle.Ciphers</span><span>
</span><a name="line-6"></a><span class="hs-comment">-- Copyright   :  (c) 2013 Stefan B&#252;hler</span><span>
</span><a name="line-7"></a><span class="hs-comment">-- License     :  MIT-style (see the file COPYING)</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- </span><span>
</span><a name="line-9"></a><span class="hs-comment">-- Maintainer  :  stbuehler@web.de</span><span>
</span><a name="line-10"></a><span class="hs-comment">-- Stability   :  experimental</span><span>
</span><a name="line-11"></a><span class="hs-comment">-- Portability :  portable</span><span>
</span><a name="line-12"></a><span class="hs-comment">--</span><span>
</span><a name="line-13"></a><span class="hs-comment">-- This module exports ciphers supported by nettle:</span><span>
</span><a name="line-14"></a><span class="hs-comment">--   &lt;http://www.lysator.liu.se/~nisse/nettle/&gt;</span><span>
</span><a name="line-15"></a><span class="hs-comment">--</span><span>
</span><a name="line-16"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-17"></a><span>
</span><a name="line-18"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Crypto</span><span class="hs-operator">.</span><span class="hs-identifier">Nettle</span><span class="hs-operator">.</span><span class="hs-identifier">Ciphers</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-19"></a><span>	</span><span class="hs-comment">-- * Block ciphers</span><span>
</span><a name="line-20"></a><span>	</span><span class="hs-comment">-- | Only block ciphers with a 128-bit 'blockSize' (16 bytes) support the XTS cipher mode.</span><span>
</span><a name="line-21"></a><span>	</span><span class="hs-comment">--</span><span>
</span><a name="line-22"></a><span>	</span><span class="hs-comment">--  For 'aeadInit' only 'AEAD_GCM' and 'AEAD_CCM' (with 'ccmInitTLS') is supported, and only if the the 'blockSize' is 16 bytes.</span><span>
</span><a name="line-23"></a><span>	</span><span class="hs-comment">--  In all other cases 'aeadInit' just returns 'Nothing'.</span><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span>	</span><span class="hs-comment">-- ** AES</span><span>
</span><a name="line-26"></a><span>	  </span><span class="hs-identifier">AES</span><span>
</span><a name="line-27"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AES128</span><span>
</span><a name="line-28"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AES192</span><span>
</span><a name="line-29"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AES256</span><span>
</span><a name="line-30"></a><span>	</span><span class="hs-comment">-- ** ARCTWO</span><span>
</span><a name="line-31"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ARCTWO</span><span>
</span><a name="line-32"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">arctwoInitEKB</span><span>
</span><a name="line-33"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">arctwoInitGutmann</span><span>
</span><a name="line-34"></a><span>	</span><span class="hs-comment">-- ** BLOWFISH</span><span>
</span><a name="line-35"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">BLOWFISH</span><span>
</span><a name="line-36"></a><span>	</span><span class="hs-comment">-- ** Camellia</span><span>
</span><a name="line-37"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Camellia</span><span>
</span><a name="line-38"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Camellia128</span><span>
</span><a name="line-39"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Camellia192</span><span>
</span><a name="line-40"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Camellia256</span><span>
</span><a name="line-41"></a><span>	</span><span class="hs-comment">-- ** CAST-128</span><span>
</span><a name="line-42"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">CAST128</span><span>
</span><a name="line-43"></a><span>	</span><span class="hs-comment">-- ** DES</span><span>
</span><a name="line-44"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">DES</span><span>
</span><a name="line-45"></a><span>	</span><span class="hs-comment">-- ** DES3 (EDE)</span><span>
</span><a name="line-46"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">DES_EDE3</span><span>
</span><a name="line-47"></a><span>	</span><span class="hs-comment">-- ** TWOFISH</span><span>
</span><a name="line-48"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">TWOFISH</span><span>
</span><a name="line-49"></a><span>	</span><span class="hs-comment">-- ** SERPENT</span><span>
</span><a name="line-50"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">SERPENT</span><span>
</span><a name="line-51"></a><span>	</span><span class="hs-comment">-- * Stream ciphers</span><span>
</span><a name="line-52"></a><span>	</span><span class="hs-comment">-- ** Nonce ciphers</span><span>
</span><a name="line-53"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">StreamNonceCipher</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-54"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">streamSetNonceWord64</span><span>
</span><a name="line-55"></a><span>	</span><span class="hs-comment">-- ** ARCFOUR</span><span>
</span><a name="line-56"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ARCFOUR</span><span>
</span><a name="line-57"></a><span>	</span><span class="hs-comment">-- ** ChaCha</span><span>
</span><a name="line-58"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">CHACHA</span><span>
</span><a name="line-59"></a><span>	</span><span class="hs-comment">-- ** Salsa20</span><span>
</span><a name="line-60"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">SALSA20</span><span>
</span><a name="line-61"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ESTREAM_SALSA20</span><span>
</span><a name="line-62"></a><span>	</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-63"></a><span>
</span><a name="line-64"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Crypto</span><span class="hs-operator">.</span><span class="hs-identifier">Cipher</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span><span>
</span><a name="line-65"></a><span class="hs-keyword">import</span><span> </span><a href="Crypto.Nettle.CCM.html"><span class="hs-identifier">Crypto</span><span class="hs-operator">.</span><span class="hs-identifier">Nettle</span><span class="hs-operator">.</span><span class="hs-identifier">CCM</span></a><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">SecureMem</span><span>
</span><a name="line-68"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">ByteString</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">B</span><span>
</span><a name="line-69"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Word</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Word64</span><span class="hs-special">)</span><span>
</span><a name="line-70"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Bits</span><span>
</span><a name="line-71"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Tagged</span><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><span class="hs-keyword">import</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html"><span class="hs-identifier">Crypto</span><span class="hs-operator">.</span><span class="hs-identifier">Nettle</span><span class="hs-operator">.</span><span class="hs-identifier">Ciphers</span><span class="hs-operator">.</span><span class="hs-identifier">Internal</span></a><span>
</span><a name="line-74"></a><span class="hs-keyword">import</span><span> </span><a href="Crypto.Nettle.Ciphers.ForeignImports.html"><span class="hs-identifier">Crypto</span><span class="hs-operator">.</span><span class="hs-identifier">Nettle</span><span class="hs-operator">.</span><span class="hs-identifier">Ciphers</span><span class="hs-operator">.</span><span class="hs-identifier">ForeignImports</span></a><span>
</span><a name="line-75"></a><span class="hs-keyword">import</span><span> </span><a href="Nettle.Utils.html"><span class="hs-identifier">Nettle</span><span class="hs-operator">.</span><span class="hs-identifier">Utils</span></a><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span class="hs-comment">-- internal functions are not camelCase on purpose</span><span>
</span><a name="line-78"></a><span class="hs-pragma">{-# ANN module &quot;HLint: ignore Use camelCase&quot; #-}</span><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span class="hs-cpp">#define INSTANCE_CIPHER(Typ) \
instance Cipher Typ where \
	{ cipherInit = nettle_cipherInit \
	; cipherName = witness nc_cipherName \
	; cipherKeySize = witness nc_cipherKeySize \
	}</span><span>
</span><a name="line-86"></a><span class="hs-cpp">#define INSTANCE_BLOCKCIPHER(Typ) \
INSTANCE_CIPHER(Typ); \
instance BlockCipher Typ where \
	{ blockSize = witness nbc_blockSize \
	; ecbEncrypt = nettle_ecbEncrypt \
	; ecbDecrypt = nettle_ecbDecrypt \
	; cbcEncrypt = nettle_cbcEncrypt \
	; cbcDecrypt = nettle_cbcDecrypt \
	; cfbEncrypt = nettle_cfbEncrypt \
	; cfbDecrypt = nettle_cfbDecrypt \
	; ctrCombine = nettle_ctrCombine \
	; aeadInit AEAD_GCM = nettle_gcm_aeadInit \
	; aeadInit AEAD_CCM = ccmInitTLS \
	; aeadInit _        = \_ _ -&gt; Nothing \
	} ; \
instance AEADModeImpl Typ NettleGCM where \
	{ aeadStateAppendHeader = nettle_gcm_aeadStateAppendHeader \
	; aeadStateEncrypt      = nettle_gcm_aeadStateEncrypt \
	; aeadStateDecrypt      = nettle_gcm_aeadStateDecrypt \
	; aeadStateFinalize     = nettle_gcm_aeadStateFinalize \
	}</span><span>
</span><a name="line-107"></a><span class="hs-cpp">#define INSTANCE_STREAMCIPHER(Typ) \
INSTANCE_CIPHER(Typ); \
instance StreamCipher Typ where \
	{ streamCombine = nettle_streamCombine \
	}</span><span>
</span><a name="line-112"></a><span class="hs-cpp">#define INSTANCE_STREAMNONCECIPHER(Typ) \
INSTANCE_STREAMCIPHER(Typ); \
instance StreamNonceCipher Typ where \
	{ streamSetNonce = nettle_streamSetNonce \
	; streamNonceSize = witness nsc_nonceSize \
	}</span><span>
</span><a name="line-118"></a><span class="hs-cpp">#define INSTANCE_BLOCKEDSTREAMCIPHER(Typ) \
INSTANCE_CIPHER(Typ); \
instance StreamCipher Typ where \
	{ streamCombine = nettle_blockedStreamCombine \
	}</span><span>
</span><a name="line-123"></a><span class="hs-cpp">#define INSTANCE_BLOCKEDSTREAMNONCECIPHER(Typ) \
INSTANCE_BLOCKEDSTREAMCIPHER(Typ); \
instance StreamNonceCipher Typ where \
	{ streamSetNonce = nettle_blockedStreamSetNonce \
	; streamNonceSize = witness nbsc_nonceSize \
	}</span><span>
</span><a name="line-129"></a><span>
</span><a name="line-130"></a><span class="hs-comment">{-|
'AES' is the generic cipher context for the AES cipher, supporting key sizes
of 128, 196 and 256 bits (16, 24 and 32 bytes). The 'blockSize' is always 128 bits (16 bytes).

'aeadInit' only supports the 'AEAD_GCM' mode for now.
-}</span><span>
</span><a name="line-136"></a><span class="hs-keyword">newtype</span><span> </span><a name="AES"><a href="Crypto.Nettle.Ciphers.html#AES"><span class="hs-identifier">AES</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="AES"><a href="Crypto.Nettle.Ciphers.html#AES"><span class="hs-identifier">AES</span></a></a><span> </span><span class="hs-identifier hs-type">SecureMem</span><span>
</span><a name="line-137"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleCipher"><span class="hs-identifier hs-type">NettleCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#AES"><span class="hs-identifier hs-type">AES</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-138"></a><span>	</span><span class="hs-identifier">nc_cipherInit</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_hs_aes_init</span><span>
</span><a name="line-139"></a><span>	</span><span class="hs-identifier">nc_cipherName</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-string">&quot;AES&quot;</span><span>
</span><a name="line-140"></a><span>	</span><span class="hs-identifier">nc_cipherKeySize</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">KeySizeEnum</span><span> </span><span class="hs-special">[</span><span class="hs-number">16</span><span class="hs-special">,</span><span class="hs-number">24</span><span class="hs-special">,</span><span class="hs-number">32</span><span class="hs-special">]</span><span>
</span><a name="line-141"></a><span>	</span><span class="hs-identifier">nc_ctx_size</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_hs_aes_ctx_size</span><span>
</span><a name="line-142"></a><span>	</span><span class="hs-identifier">nc_ctx</span><span>   </span><span class="hs-special">(</span><a name="local-8214565720323827383"><a href="Crypto.Nettle.Ciphers.Internal.html#nc_ctx"><span class="hs-identifier">AES</span></a></a><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Nettle.Ciphers.html#AES"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-143"></a><span>	</span><span class="hs-identifier">nc_Ctx</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">AES</span><span>
</span><a name="line-144"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleBlockCipher"><span class="hs-identifier hs-type">NettleBlockCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#AES"><span class="hs-identifier hs-type">AES</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-145"></a><span>	</span><span class="hs-identifier">nbc_blockSize</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-number">16</span><span>
</span><a name="line-146"></a><span>	</span><span class="hs-identifier">nbc_ecb_encrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_hs_aes_encrypt</span><span>
</span><a name="line-147"></a><span>	</span><span class="hs-identifier">nbc_ecb_decrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_hs_aes_decrypt</span><span>
</span><a name="line-148"></a><span>	</span><span class="hs-identifier">nbc_fun_encrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">p_hs_aes_encrypt</span><span>
</span><a name="line-149"></a><span>	</span><span class="hs-identifier">nbc_fun_decrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">p_hs_aes_decrypt</span><span>
</span><a name="line-150"></a><span>
</span><a name="line-151"></a><span class="hs-identifier">INSTANCE_BLOCKCIPHER</span><span class="hs-special">(</span><span class="hs-identifier">AES</span><span class="hs-special">)</span><span>
</span><a name="line-152"></a><span>
</span><a name="line-153"></a><span class="hs-comment">{-|
'AES128' provides the same interface as 'AES', but is restricted to 128-bit keys.
-}</span><span>
</span><a name="line-156"></a><span class="hs-keyword">newtype</span><span> </span><a name="AES128"><a href="Crypto.Nettle.Ciphers.html#AES128"><span class="hs-identifier">AES128</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="AES128"><a href="Crypto.Nettle.Ciphers.html#AES128"><span class="hs-identifier">AES128</span></a></a><span> </span><span class="hs-identifier hs-type">SecureMem</span><span>
</span><a name="line-157"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleCipher"><span class="hs-identifier hs-type">NettleCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#AES128"><span class="hs-identifier hs-type">AES128</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-158"></a><span>	</span><span class="hs-identifier">nc_cipherInit</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier hs-var">ctx</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">key</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c_hs_aes128_init</span><span> </span><a href="Crypto.Nettle.Ciphers.ForeignImports.html#c_hs_aes128_init"><span class="hs-identifier hs-var">ctx</span></a><span> </span><span class="hs-identifier">key</span><span class="hs-special">)</span><span>
</span><a name="line-159"></a><span>	</span><span class="hs-identifier">nc_cipherName</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-string">&quot;AES-128&quot;</span><span>
</span><a name="line-160"></a><span>	</span><span class="hs-identifier">nc_cipherKeySize</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">KeySizeFixed</span><span> </span><span class="hs-number">16</span><span>
</span><a name="line-161"></a><span>	</span><span class="hs-identifier">nc_ctx_size</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_hs_aes128_ctx_size</span><span>
</span><a name="line-162"></a><span>	</span><span class="hs-identifier">nc_ctx</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AES128</span><span> </span><a href="Crypto.Nettle.Ciphers.html#AES128"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Nettle.Ciphers.html#AES128"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-163"></a><span>	</span><span class="hs-identifier">nc_Ctx</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">AES128</span><span>
</span><a name="line-164"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleBlockCipher"><span class="hs-identifier hs-type">NettleBlockCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#AES128"><span class="hs-identifier hs-type">AES128</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-165"></a><span>	</span><span class="hs-identifier">nbc_blockSize</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-number">16</span><span>
</span><a name="line-166"></a><span>	</span><span class="hs-identifier">nbc_encrypt_ctx_offset</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_hs_aes128_ctx_encrypt</span><span>
</span><a name="line-167"></a><span>	</span><span class="hs-identifier">nbc_decrypt_ctx_offset</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_hs_aes128_ctx_decrypt</span><span>
</span><a name="line-168"></a><span>	</span><span class="hs-identifier">nbc_ecb_encrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_aes128_encrypt</span><span>
</span><a name="line-169"></a><span>	</span><span class="hs-identifier">nbc_ecb_decrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_aes128_decrypt</span><span>
</span><a name="line-170"></a><span>	</span><span class="hs-identifier">nbc_fun_encrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">p_aes128_encrypt</span><span>
</span><a name="line-171"></a><span>	</span><span class="hs-identifier">nbc_fun_decrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">p_aes128_decrypt</span><span>
</span><a name="line-172"></a><span>
</span><a name="line-173"></a><span class="hs-identifier">INSTANCE_BLOCKCIPHER</span><span class="hs-special">(</span><span class="hs-identifier">AES128</span><span class="hs-special">)</span><span>
</span><a name="line-174"></a><span>
</span><a name="line-175"></a><span>
</span><a name="line-176"></a><span class="hs-comment">{-|
'AES192' provides the same interface as 'AES', but is restricted to 192-bit keys.
-}</span><span>
</span><a name="line-179"></a><span class="hs-keyword">newtype</span><span> </span><a name="AES192"><a href="Crypto.Nettle.Ciphers.html#AES192"><span class="hs-identifier">AES192</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="AES192"><a href="Crypto.Nettle.Ciphers.html#AES192"><span class="hs-identifier">AES192</span></a></a><span> </span><span class="hs-identifier hs-type">SecureMem</span><span>
</span><a name="line-180"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleCipher"><span class="hs-identifier hs-type">NettleCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#AES192"><span class="hs-identifier hs-type">AES192</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-181"></a><span>	</span><span class="hs-identifier">nc_cipherInit</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier hs-var">ctx</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">key</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c_hs_aes192_init</span><span> </span><a href="Crypto.Nettle.Ciphers.ForeignImports.html#c_hs_aes192_init"><span class="hs-identifier hs-var">ctx</span></a><span> </span><span class="hs-identifier">key</span><span class="hs-special">)</span><span>
</span><a name="line-182"></a><span>	</span><span class="hs-identifier">nc_cipherName</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-string">&quot;AES-192&quot;</span><span>
</span><a name="line-183"></a><span>	</span><span class="hs-identifier">nc_cipherKeySize</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">KeySizeFixed</span><span> </span><span class="hs-number">24</span><span>
</span><a name="line-184"></a><span>	</span><span class="hs-identifier">nc_ctx_size</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_hs_aes192_ctx_size</span><span>
</span><a name="line-185"></a><span>	</span><span class="hs-identifier">nc_ctx</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">AES192</span><span> </span><a href="Crypto.Nettle.Ciphers.html#AES192"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Nettle.Ciphers.html#AES192"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-186"></a><span>	</span><span class="hs-identifier">nc_Ctx</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">AES192</span><span>
</span><a name="line-187"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleBlockCipher"><span class="hs-identifier hs-type">NettleBlockCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#AES192"><span class="hs-identifier hs-type">AES192</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-188"></a><span>	</span><span class="hs-identifier">nbc_blockSize</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-number">16</span><span>
</span><a name="line-189"></a><span>	</span><span class="hs-identifier">nbc_encrypt_ctx_offset</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_hs_aes192_ctx_encrypt</span><span>
</span><a name="line-190"></a><span>	</span><span class="hs-identifier">nbc_decrypt_ctx_offset</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_hs_aes192_ctx_decrypt</span><span>
</span><a name="line-191"></a><span>	</span><span class="hs-identifier">nbc_ecb_encrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_aes192_encrypt</span><span>
</span><a name="line-192"></a><span>	</span><span class="hs-identifier">nbc_ecb_decrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_aes192_decrypt</span><span>
</span><a name="line-193"></a><span>	</span><span class="hs-identifier">nbc_fun_encrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">p_aes192_encrypt</span><span>
</span><a name="line-194"></a><span>	</span><span class="hs-identifier">nbc_fun_decrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">p_aes192_decrypt</span><span>
</span><a name="line-195"></a><span>
</span><a name="line-196"></a><span class="hs-identifier">INSTANCE_BLOCKCIPHER</span><span class="hs-special">(</span><span class="hs-identifier">AES192</span><span class="hs-special">)</span><span>
</span><a name="line-197"></a><span>
</span><a name="line-198"></a><span>
</span><a name="line-199"></a><span class="hs-comment">{-|
'AES256' provides the same interface as 'AES', but is restricted to 256-bit keys.
-}</span><span>
</span><a name="line-202"></a><span class="hs-keyword">newtype</span><span> </span><a name="AES256"><a href="Crypto.Nettle.Ciphers.html#AES256"><span class="hs-identifier">AES256</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="AES256"><a href="Crypto.Nettle.Ciphers.html#AES256"><span class="hs-identifier">AES256</span></a></a><span> </span><span class="hs-identifier hs-type">SecureMem</span><span>
</span><a name="line-203"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleCipher"><span class="hs-identifier hs-type">NettleCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#AES256"><span class="hs-identifier hs-type">AES256</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-204"></a><span>	</span><span class="hs-identifier">nc_cipherInit</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier hs-var">ctx</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">key</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c_hs_aes256_init</span><span> </span><a href="Crypto.Nettle.Ciphers.ForeignImports.html#c_hs_aes256_init"><span class="hs-identifier hs-var">ctx</span></a><span> </span><span class="hs-identifier">key</span><span class="hs-special">)</span><span>
</span><a name="line-205"></a><span>	</span><span class="hs-identifier">nc_cipherName</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-string">&quot;AES-256&quot;</span><span>
</span><a name="line-206"></a><span>	</span><span class="hs-identifier">nc_cipherKeySize</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">KeySizeFixed</span><span> </span><span class="hs-number">32</span><span>
</span><a name="line-207"></a><span>	</span><span class="hs-identifier">nc_ctx_size</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_hs_aes256_ctx_size</span><span>
</span><a name="line-208"></a><span>	</span><span class="hs-identifier">nc_ctx</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">AES256</span><span> </span><a href="Crypto.Nettle.Ciphers.html#AES256"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Nettle.Ciphers.html#AES256"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-209"></a><span>	</span><span class="hs-identifier">nc_Ctx</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">AES256</span><span>
</span><a name="line-210"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleBlockCipher"><span class="hs-identifier hs-type">NettleBlockCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#AES256"><span class="hs-identifier hs-type">AES256</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-211"></a><span>	</span><span class="hs-identifier">nbc_blockSize</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-number">16</span><span>
</span><a name="line-212"></a><span>	</span><span class="hs-identifier">nbc_encrypt_ctx_offset</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_hs_aes256_ctx_encrypt</span><span>
</span><a name="line-213"></a><span>	</span><span class="hs-identifier">nbc_decrypt_ctx_offset</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_hs_aes256_ctx_decrypt</span><span>
</span><a name="line-214"></a><span>	</span><span class="hs-identifier">nbc_ecb_encrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_aes256_encrypt</span><span>
</span><a name="line-215"></a><span>	</span><span class="hs-identifier">nbc_ecb_decrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_aes256_decrypt</span><span>
</span><a name="line-216"></a><span>	</span><span class="hs-identifier">nbc_fun_encrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">p_aes256_encrypt</span><span>
</span><a name="line-217"></a><span>	</span><span class="hs-identifier">nbc_fun_decrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">p_aes256_decrypt</span><span>
</span><a name="line-218"></a><span>
</span><a name="line-219"></a><span class="hs-identifier">INSTANCE_BLOCKCIPHER</span><span class="hs-special">(</span><span class="hs-identifier">AES256</span><span class="hs-special">)</span><span>
</span><a name="line-220"></a><span>
</span><a name="line-221"></a><span>
</span><a name="line-222"></a><span class="hs-comment">{-|
'ARCTWO' (also known as the trade marked name RC2) is a block cipher specified in RFC 2268.

The default 'cipherInit' uses @ekb = bit-length of the key@; 'arctwoInitEKB' allows to specify ekb manually.
'arctwoInitGutmann' uses @ekb = 1024@ (the maximum).

'ARCTWO' uses keysizes from 1 to 128 bytes, and uses a 'blockSize' of 64 bits (8 bytes).
-}</span><span>
</span><a name="line-230"></a><span class="hs-keyword">newtype</span><span> </span><a name="ARCTWO"><a href="Crypto.Nettle.Ciphers.html#ARCTWO"><span class="hs-identifier">ARCTWO</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="ARCTWO"><a href="Crypto.Nettle.Ciphers.html#ARCTWO"><span class="hs-identifier">ARCTWO</span></a></a><span> </span><span class="hs-identifier hs-type">SecureMem</span><span>
</span><a name="line-231"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleCipher"><span class="hs-identifier hs-type">NettleCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#ARCTWO"><span class="hs-identifier hs-type">ARCTWO</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-232"></a><span>	</span><span class="hs-identifier">nc_cipherInit</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_arctwo_set_key</span><span>
</span><a name="line-233"></a><span>	</span><span class="hs-identifier">nc_cipherName</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-string">&quot;ARCTWO&quot;</span><span>
</span><a name="line-234"></a><span>	</span><span class="hs-identifier">nc_cipherKeySize</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">KeySizeRange</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">128</span><span>
</span><a name="line-235"></a><span>	</span><span class="hs-identifier">nc_ctx_size</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_arctwo_ctx_size</span><span>
</span><a name="line-236"></a><span>	</span><span class="hs-identifier">nc_ctx</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">ARCTWO</span><span> </span><a href="Crypto.Nettle.Ciphers.html#ARCTWO"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Nettle.Ciphers.html#ARCTWO"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-237"></a><span>	</span><span class="hs-identifier">nc_Ctx</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ARCTWO</span><span>
</span><a name="line-238"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleBlockCipher"><span class="hs-identifier hs-type">NettleBlockCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#ARCTWO"><span class="hs-identifier hs-type">ARCTWO</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-239"></a><span>	</span><span class="hs-identifier">nbc_blockSize</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-number">8</span><span>
</span><a name="line-240"></a><span>	</span><span class="hs-identifier">nbc_ecb_encrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_arctwo_encrypt</span><span>
</span><a name="line-241"></a><span>	</span><span class="hs-identifier">nbc_ecb_decrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_arctwo_decrypt</span><span>
</span><a name="line-242"></a><span>	</span><span class="hs-identifier">nbc_fun_encrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">p_arctwo_encrypt</span><span>
</span><a name="line-243"></a><span>	</span><span class="hs-identifier">nbc_fun_decrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">p_arctwo_decrypt</span><span>
</span><a name="line-244"></a><span class="hs-identifier">INSTANCE_BLOCKCIPHER</span><span class="hs-special">(</span><span class="hs-identifier">ARCTWO</span><span class="hs-special">)</span><span>
</span><a name="line-245"></a><span class="hs-comment">{-|
Initialize cipher with an explicit @ekb@ value (valid values from 1 to 1024, 0 meaning the same as 1024).
-}</span><span>
</span><a name="line-248"></a><span class="hs-identifier">arctwoInitEKB</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Key</span><span> </span><a href="Crypto.Nettle.Ciphers.html#ARCTWO"><span class="hs-identifier hs-type">ARCTWO</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Word</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Crypto.Nettle.Ciphers.html#ARCTWO"><span class="hs-identifier hs-type">ARCTWO</span></a><span>
</span><a name="line-249"></a><a name="arctwoInitEKB"><a href="Crypto.Nettle.Ciphers.html#arctwoInitEKB"><span class="hs-identifier">arctwoInitEKB</span></a></a><span> </span><a name="local-6989586621679056783"><a href="#local-6989586621679056783"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679056784"><a href="#local-6989586621679056784"><span class="hs-identifier">ekb</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#nettle_cipherInit%27"><span class="hs-identifier hs-var">nettle_cipherInit'</span></a><span> </span><a href="#local-6989586621679056785"><span class="hs-identifier hs-var">initfun</span></a><span> </span><a href="#local-6989586621679056783"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-250"></a><span>	</span><span class="hs-identifier">initfun</span><span> </span><a name="local-6989586621679056785"><a href="#local-6989586621679056785"><span class="hs-identifier">ctxptr</span></a></a><span> </span><a name="local-6989586621679056786"><a href="#local-6989586621679056786"><span class="hs-identifier">ksize</span></a></a><span> </span><span class="hs-identifier">ptr</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">c_arctwo_set_key_ekb</span><span> </span><a href="Crypto.Nettle.Ciphers.ForeignImports.html#c_arctwo_set_key_ekb"><span class="hs-identifier hs-var">ctxptr</span></a><span> </span><a href="#local-6989586621679056786"><span class="hs-identifier hs-var">ksize</span></a><span> </span><span class="hs-identifier">ptr</span><span> </span><span class="hs-identifier">ekb</span><span>
</span><a name="line-251"></a><span class="hs-comment">{-|
Initialize cipher with @ekb = 1024@.
-}</span><span>
</span><a name="line-254"></a><span class="hs-identifier">arctwoInitGutmann</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Key</span><span> </span><a href="Crypto.Nettle.Ciphers.html#ARCTWO"><span class="hs-identifier hs-type">ARCTWO</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Crypto.Nettle.Ciphers.html#ARCTWO"><span class="hs-identifier hs-type">ARCTWO</span></a><span>
</span><a name="line-255"></a><a name="arctwoInitGutmann"><a href="Crypto.Nettle.Ciphers.html#arctwoInitGutmann"><span class="hs-identifier">arctwoInitGutmann</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#nettle_cipherInit%27"><span class="hs-identifier hs-var">nettle_cipherInit'</span></a><span> </span><a href="Crypto.Nettle.Ciphers.ForeignImports.html#c_arctwo_set_key_gutmann"><span class="hs-identifier hs-var">c_arctwo_set_key_gutmann</span></a><span>
</span><a name="line-256"></a><span>
</span><a name="line-257"></a><span>
</span><a name="line-258"></a><span class="hs-comment">{-|
'BLOWFISH' is a block cipher designed by Bruce Schneier.
It uses a 'blockSize' of 64 bits (8 bytes), and a variable key size from 64 to 448 bits (8 to 56 bytes).
-}</span><span>
</span><a name="line-262"></a><span class="hs-keyword">newtype</span><span> </span><a name="BLOWFISH"><a href="Crypto.Nettle.Ciphers.html#BLOWFISH"><span class="hs-identifier">BLOWFISH</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="BLOWFISH"><a href="Crypto.Nettle.Ciphers.html#BLOWFISH"><span class="hs-identifier">BLOWFISH</span></a></a><span> </span><span class="hs-identifier hs-type">SecureMem</span><span>
</span><a name="line-263"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleCipher"><span class="hs-identifier hs-type">NettleCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#BLOWFISH"><span class="hs-identifier hs-type">BLOWFISH</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-264"></a><span>	</span><span class="hs-identifier">nc_cipherInit</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_blowfish_set_key</span><span>
</span><a name="line-265"></a><span>	</span><span class="hs-identifier">nc_cipherName</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-string">&quot;BLOWFISH&quot;</span><span>
</span><a name="line-266"></a><span>	</span><span class="hs-identifier">nc_cipherKeySize</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">KeySizeRange</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">128</span><span>
</span><a name="line-267"></a><span>	</span><span class="hs-identifier">nc_ctx_size</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_blowfish_ctx_size</span><span>
</span><a name="line-268"></a><span>	</span><span class="hs-identifier">nc_ctx</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">BLOWFISH</span><span> </span><a href="Crypto.Nettle.Ciphers.html#BLOWFISH"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Nettle.Ciphers.html#BLOWFISH"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-269"></a><span>	</span><span class="hs-identifier">nc_Ctx</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">BLOWFISH</span><span>
</span><a name="line-270"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleBlockCipher"><span class="hs-identifier hs-type">NettleBlockCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#BLOWFISH"><span class="hs-identifier hs-type">BLOWFISH</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-271"></a><span>	</span><span class="hs-identifier">nbc_blockSize</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-number">8</span><span>
</span><a name="line-272"></a><span>	</span><span class="hs-identifier">nbc_ecb_encrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_blowfish_encrypt</span><span>
</span><a name="line-273"></a><span>	</span><span class="hs-identifier">nbc_ecb_decrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_blowfish_decrypt</span><span>
</span><a name="line-274"></a><span>	</span><span class="hs-identifier">nbc_fun_encrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">p_blowfish_encrypt</span><span>
</span><a name="line-275"></a><span>	</span><span class="hs-identifier">nbc_fun_decrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">p_blowfish_decrypt</span><span>
</span><a name="line-276"></a><span class="hs-identifier">INSTANCE_BLOCKCIPHER</span><span class="hs-special">(</span><span class="hs-identifier">BLOWFISH</span><span class="hs-special">)</span><span>
</span><a name="line-277"></a><span>
</span><a name="line-278"></a><span>
</span><a name="line-279"></a><span class="hs-comment">{-|
Camellia is a block cipher developed by Mitsubishi and Nippon Telegraph and Telephone Corporation,
described in RFC3713, and recommended by some Japanese and European authorities as an alternative to AES.
The algorithm is patented (details see &lt;http://www.lysator.liu.se/~nisse/nettle/nettle.html&gt;).

Camellia uses a the same 'blockSize' and key sizes as 'AES'.

'aeadInit' only supports the 'AEAD_GCM' mode for now.
-}</span><span>
</span><a name="line-288"></a><span class="hs-keyword">newtype</span><span> </span><a name="Camellia"><a href="Crypto.Nettle.Ciphers.html#Camellia"><span class="hs-identifier">Camellia</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Camellia"><a href="Crypto.Nettle.Ciphers.html#Camellia"><span class="hs-identifier">Camellia</span></a></a><span> </span><span class="hs-identifier hs-type">SecureMem</span><span>
</span><a name="line-289"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleCipher"><span class="hs-identifier hs-type">NettleCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#Camellia"><span class="hs-identifier hs-type">Camellia</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-290"></a><span>	</span><span class="hs-identifier">nc_cipherInit</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_hs_camellia_init</span><span>
</span><a name="line-291"></a><span>	</span><span class="hs-identifier">nc_cipherName</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-string">&quot;Camellia&quot;</span><span>
</span><a name="line-292"></a><span>	</span><span class="hs-identifier">nc_cipherKeySize</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">KeySizeEnum</span><span> </span><span class="hs-special">[</span><span class="hs-number">16</span><span class="hs-special">,</span><span class="hs-number">24</span><span class="hs-special">,</span><span class="hs-number">32</span><span class="hs-special">]</span><span>
</span><a name="line-293"></a><span>	</span><span class="hs-identifier">nc_ctx_size</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_hs_camellia_ctx_size</span><span>
</span><a name="line-294"></a><span>	</span><span class="hs-identifier">nc_ctx</span><span>     </span><span class="hs-special">(</span><span class="hs-identifier">Camellia</span><span> </span><a href="Crypto.Nettle.Ciphers.html#Camellia"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Nettle.Ciphers.html#Camellia"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-295"></a><span>	</span><span class="hs-identifier">nc_Ctx</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Camellia</span><span>
</span><a name="line-296"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleBlockCipher"><span class="hs-identifier hs-type">NettleBlockCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#Camellia"><span class="hs-identifier hs-type">Camellia</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-297"></a><span>	</span><span class="hs-identifier">nbc_blockSize</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-number">16</span><span>
</span><a name="line-298"></a><span>	</span><span class="hs-identifier">nbc_ecb_encrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_hs_camellia_encrypt</span><span>
</span><a name="line-299"></a><span>	</span><span class="hs-identifier">nbc_ecb_decrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_hs_camellia_decrypt</span><span>
</span><a name="line-300"></a><span>	</span><span class="hs-identifier">nbc_fun_encrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">p_hs_camellia_encrypt</span><span>
</span><a name="line-301"></a><span>	</span><span class="hs-identifier">nbc_fun_decrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">p_hs_camellia_decrypt</span><span>
</span><a name="line-302"></a><span>
</span><a name="line-303"></a><span class="hs-identifier">INSTANCE_BLOCKCIPHER</span><span class="hs-special">(</span><span class="hs-identifier">Camellia</span><span class="hs-special">)</span><span>
</span><a name="line-304"></a><span>
</span><a name="line-305"></a><span class="hs-comment">{-|
'Camellia128' provides the same interface as 'Camellia', but is restricted to 128-bit keys.
-}</span><span>
</span><a name="line-308"></a><span class="hs-keyword">newtype</span><span> </span><a name="Camellia128"><a href="Crypto.Nettle.Ciphers.html#Camellia128"><span class="hs-identifier">Camellia128</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Camellia128"><a href="Crypto.Nettle.Ciphers.html#Camellia128"><span class="hs-identifier">Camellia128</span></a></a><span> </span><span class="hs-identifier hs-type">SecureMem</span><span>
</span><a name="line-309"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleCipher"><span class="hs-identifier hs-type">NettleCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#Camellia128"><span class="hs-identifier hs-type">Camellia128</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-310"></a><span>	</span><span class="hs-identifier">nc_cipherInit</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier hs-var">ctx</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">key</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c_hs_camellia128_init</span><span> </span><a href="Crypto.Nettle.Ciphers.ForeignImports.html#c_hs_camellia128_init"><span class="hs-identifier hs-var">ctx</span></a><span> </span><span class="hs-identifier">key</span><span class="hs-special">)</span><span>
</span><a name="line-311"></a><span>	</span><span class="hs-identifier">nc_cipherName</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-string">&quot;Camellia-128&quot;</span><span>
</span><a name="line-312"></a><span>	</span><span class="hs-identifier">nc_cipherKeySize</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">KeySizeFixed</span><span> </span><span class="hs-number">16</span><span>
</span><a name="line-313"></a><span>	</span><span class="hs-identifier">nc_ctx_size</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_hs_camellia128_ctx_size</span><span>
</span><a name="line-314"></a><span>	</span><span class="hs-identifier">nc_ctx</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">Camellia128</span><span> </span><a href="Crypto.Nettle.Ciphers.html#Camellia128"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Nettle.Ciphers.html#Camellia128"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-315"></a><span>	</span><span class="hs-identifier">nc_Ctx</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Camellia128</span><span>
</span><a name="line-316"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleBlockCipher"><span class="hs-identifier hs-type">NettleBlockCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#Camellia128"><span class="hs-identifier hs-type">Camellia128</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-317"></a><span>	</span><span class="hs-identifier">nbc_blockSize</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-number">16</span><span>
</span><a name="line-318"></a><span>	</span><span class="hs-identifier">nbc_encrypt_ctx_offset</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_hs_camellia128_ctx_encrypt</span><span>
</span><a name="line-319"></a><span>	</span><span class="hs-identifier">nbc_decrypt_ctx_offset</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_hs_camellia128_ctx_decrypt</span><span>
</span><a name="line-320"></a><span>	</span><span class="hs-identifier">nbc_ecb_encrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_camellia128_crypt</span><span>
</span><a name="line-321"></a><span>	</span><span class="hs-identifier">nbc_ecb_decrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_camellia128_crypt</span><span>
</span><a name="line-322"></a><span>	</span><span class="hs-identifier">nbc_fun_encrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">p_camellia128_crypt</span><span>
</span><a name="line-323"></a><span>	</span><span class="hs-identifier">nbc_fun_decrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">p_camellia128_crypt</span><span>
</span><a name="line-324"></a><span>
</span><a name="line-325"></a><span class="hs-identifier">INSTANCE_BLOCKCIPHER</span><span class="hs-special">(</span><span class="hs-identifier">Camellia128</span><span class="hs-special">)</span><span>
</span><a name="line-326"></a><span>
</span><a name="line-327"></a><span class="hs-comment">{-|
'Camellia192' provides the same interface as 'Camellia', but is restricted to 192-bit keys.
-}</span><span>
</span><a name="line-330"></a><span class="hs-keyword">newtype</span><span> </span><a name="Camellia192"><a href="Crypto.Nettle.Ciphers.html#Camellia192"><span class="hs-identifier">Camellia192</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Camellia192"><a href="Crypto.Nettle.Ciphers.html#Camellia192"><span class="hs-identifier">Camellia192</span></a></a><span> </span><span class="hs-identifier hs-type">SecureMem</span><span>
</span><a name="line-331"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleCipher"><span class="hs-identifier hs-type">NettleCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#Camellia192"><span class="hs-identifier hs-type">Camellia192</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-332"></a><span>	</span><span class="hs-identifier">nc_cipherInit</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier hs-var">ctx</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">key</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c_hs_camellia192_init</span><span> </span><a href="Crypto.Nettle.Ciphers.ForeignImports.html#c_hs_camellia192_init"><span class="hs-identifier hs-var">ctx</span></a><span> </span><span class="hs-identifier">key</span><span class="hs-special">)</span><span>
</span><a name="line-333"></a><span>	</span><span class="hs-identifier">nc_cipherName</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-string">&quot;Camellia-192&quot;</span><span>
</span><a name="line-334"></a><span>	</span><span class="hs-identifier">nc_cipherKeySize</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">KeySizeFixed</span><span> </span><span class="hs-number">24</span><span>
</span><a name="line-335"></a><span>	</span><span class="hs-identifier">nc_ctx_size</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_hs_camellia192_ctx_size</span><span>
</span><a name="line-336"></a><span>	</span><span class="hs-identifier">nc_ctx</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">Camellia192</span><span> </span><a href="Crypto.Nettle.Ciphers.html#Camellia192"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Nettle.Ciphers.html#Camellia192"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-337"></a><span>	</span><span class="hs-identifier">nc_Ctx</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Camellia192</span><span>
</span><a name="line-338"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleBlockCipher"><span class="hs-identifier hs-type">NettleBlockCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#Camellia192"><span class="hs-identifier hs-type">Camellia192</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-339"></a><span>	</span><span class="hs-identifier">nbc_blockSize</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-number">16</span><span>
</span><a name="line-340"></a><span>	</span><span class="hs-identifier">nbc_encrypt_ctx_offset</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_hs_camellia192_ctx_encrypt</span><span>
</span><a name="line-341"></a><span>	</span><span class="hs-identifier">nbc_decrypt_ctx_offset</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_hs_camellia192_ctx_decrypt</span><span>
</span><a name="line-342"></a><span>	</span><span class="hs-identifier">nbc_ecb_encrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_camellia192_crypt</span><span>
</span><a name="line-343"></a><span>	</span><span class="hs-identifier">nbc_ecb_decrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_camellia192_crypt</span><span>
</span><a name="line-344"></a><span>	</span><span class="hs-identifier">nbc_fun_encrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">p_camellia192_crypt</span><span>
</span><a name="line-345"></a><span>	</span><span class="hs-identifier">nbc_fun_decrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">p_camellia192_crypt</span><span>
</span><a name="line-346"></a><span>
</span><a name="line-347"></a><span class="hs-identifier">INSTANCE_BLOCKCIPHER</span><span class="hs-special">(</span><span class="hs-identifier">Camellia192</span><span class="hs-special">)</span><span>
</span><a name="line-348"></a><span>
</span><a name="line-349"></a><span class="hs-comment">{-|
'Camellia256' provides the same interface as 'Camellia', but is restricted to 256-bit keys.
-}</span><span>
</span><a name="line-352"></a><span class="hs-keyword">newtype</span><span> </span><a name="Camellia256"><a href="Crypto.Nettle.Ciphers.html#Camellia256"><span class="hs-identifier">Camellia256</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Camellia256"><a href="Crypto.Nettle.Ciphers.html#Camellia256"><span class="hs-identifier">Camellia256</span></a></a><span> </span><span class="hs-identifier hs-type">SecureMem</span><span>
</span><a name="line-353"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleCipher"><span class="hs-identifier hs-type">NettleCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#Camellia256"><span class="hs-identifier hs-type">Camellia256</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-354"></a><span>	</span><span class="hs-identifier">nc_cipherInit</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier hs-var">ctx</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">key</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c_hs_camellia256_init</span><span> </span><a href="Crypto.Nettle.Ciphers.ForeignImports.html#c_hs_camellia256_init"><span class="hs-identifier hs-var">ctx</span></a><span> </span><span class="hs-identifier">key</span><span class="hs-special">)</span><span>
</span><a name="line-355"></a><span>	</span><span class="hs-identifier">nc_cipherName</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-string">&quot;Camellia-256&quot;</span><span>
</span><a name="line-356"></a><span>	</span><span class="hs-identifier">nc_cipherKeySize</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">KeySizeFixed</span><span> </span><span class="hs-number">32</span><span>
</span><a name="line-357"></a><span>	</span><span class="hs-identifier">nc_ctx_size</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_hs_camellia256_ctx_size</span><span>
</span><a name="line-358"></a><span>	</span><span class="hs-identifier">nc_ctx</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">Camellia256</span><span> </span><a href="Crypto.Nettle.Ciphers.html#Camellia256"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Nettle.Ciphers.html#Camellia256"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-359"></a><span>	</span><span class="hs-identifier">nc_Ctx</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Camellia256</span><span>
</span><a name="line-360"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleBlockCipher"><span class="hs-identifier hs-type">NettleBlockCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#Camellia256"><span class="hs-identifier hs-type">Camellia256</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-361"></a><span>	</span><span class="hs-identifier">nbc_blockSize</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-number">16</span><span>
</span><a name="line-362"></a><span>	</span><span class="hs-identifier">nbc_encrypt_ctx_offset</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_hs_camellia256_ctx_encrypt</span><span>
</span><a name="line-363"></a><span>	</span><span class="hs-identifier">nbc_decrypt_ctx_offset</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_hs_camellia256_ctx_decrypt</span><span>
</span><a name="line-364"></a><span>	</span><span class="hs-identifier">nbc_ecb_encrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_camellia256_crypt</span><span>
</span><a name="line-365"></a><span>	</span><span class="hs-identifier">nbc_ecb_decrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_camellia256_crypt</span><span>
</span><a name="line-366"></a><span>	</span><span class="hs-identifier">nbc_fun_encrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">p_camellia256_crypt</span><span>
</span><a name="line-367"></a><span>	</span><span class="hs-identifier">nbc_fun_decrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">p_camellia256_crypt</span><span>
</span><a name="line-368"></a><span>
</span><a name="line-369"></a><span class="hs-identifier">INSTANCE_BLOCKCIPHER</span><span class="hs-special">(</span><span class="hs-identifier">Camellia256</span><span class="hs-special">)</span><span>
</span><a name="line-370"></a><span>
</span><a name="line-371"></a><span class="hs-comment">{-|
'CAST128' is a block cipher specified in RFC 2144. It uses a 64 bit (8 bytes) 'blockSize',
and a variable key size of 40 up to 128 bits (5 to 16 bytes).
-}</span><span>
</span><a name="line-375"></a><span class="hs-keyword">newtype</span><span> </span><a name="CAST128"><a href="Crypto.Nettle.Ciphers.html#CAST128"><span class="hs-identifier">CAST128</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="CAST128"><a href="Crypto.Nettle.Ciphers.html#CAST128"><span class="hs-identifier">CAST128</span></a></a><span> </span><span class="hs-identifier hs-type">SecureMem</span><span>
</span><a name="line-376"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleCipher"><span class="hs-identifier hs-type">NettleCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#CAST128"><span class="hs-identifier hs-type">CAST128</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-377"></a><span>	</span><span class="hs-identifier">nc_cipherInit</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_cast5_set_key</span><span>
</span><a name="line-378"></a><span>	</span><span class="hs-identifier">nc_cipherName</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-string">&quot;CAST-128&quot;</span><span>
</span><a name="line-379"></a><span>	</span><span class="hs-identifier">nc_cipherKeySize</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">KeySizeRange</span><span> </span><span class="hs-number">5</span><span> </span><span class="hs-number">16</span><span>
</span><a name="line-380"></a><span>	</span><span class="hs-identifier">nc_ctx_size</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_cast128_ctx_size</span><span>
</span><a name="line-381"></a><span>	</span><span class="hs-identifier">nc_ctx</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">CAST128</span><span> </span><a href="Crypto.Nettle.Ciphers.html#CAST128"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Nettle.Ciphers.html#CAST128"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-382"></a><span>	</span><span class="hs-identifier">nc_Ctx</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">CAST128</span><span>
</span><a name="line-383"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleBlockCipher"><span class="hs-identifier hs-type">NettleBlockCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#CAST128"><span class="hs-identifier hs-type">CAST128</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-384"></a><span>	</span><span class="hs-identifier">nbc_blockSize</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-number">8</span><span>
</span><a name="line-385"></a><span>	</span><span class="hs-identifier">nbc_ecb_encrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_cast128_encrypt</span><span>
</span><a name="line-386"></a><span>	</span><span class="hs-identifier">nbc_ecb_decrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_cast128_decrypt</span><span>
</span><a name="line-387"></a><span>	</span><span class="hs-identifier">nbc_fun_encrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">p_cast128_encrypt</span><span>
</span><a name="line-388"></a><span>	</span><span class="hs-identifier">nbc_fun_decrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">p_cast128_decrypt</span><span>
</span><a name="line-389"></a><span>
</span><a name="line-390"></a><span class="hs-identifier">INSTANCE_BLOCKCIPHER</span><span class="hs-special">(</span><span class="hs-identifier">CAST128</span><span class="hs-special">)</span><span>
</span><a name="line-391"></a><span>
</span><a name="line-392"></a><span class="hs-comment">{-|
'DES' is the old Data Encryption Standard, specified by NIST.
It uses a 'blockSize' of 64 bits (8 bytes), and a key size of 56 bits.

The key is given as 8 bytes, as one bit per byte is used as a parity bit.
The parity bit is ignored by this implementation.
-}</span><span>
</span><a name="line-399"></a><span class="hs-keyword">newtype</span><span> </span><a name="DES"><a href="Crypto.Nettle.Ciphers.html#DES"><span class="hs-identifier">DES</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="DES"><a href="Crypto.Nettle.Ciphers.html#DES"><span class="hs-identifier">DES</span></a></a><span> </span><span class="hs-identifier hs-type">SecureMem</span><span>
</span><a name="line-400"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleCipher"><span class="hs-identifier hs-type">NettleCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#DES"><span class="hs-identifier hs-type">DES</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-401"></a><span>	</span><span class="hs-identifier">nc_cipherInit</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">ctxptr</span><span> </span><a name="local-6989586621679056757"><a href="#local-6989586621679056757"><span class="hs-identifier">_</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c_des_set_key</span><span> </span><a href="Crypto.Nettle.Ciphers.ForeignImports.html#c_des_set_key"><span class="hs-identifier hs-var">ctxptr</span></a><span>
</span><a name="line-402"></a><span>	</span><span class="hs-identifier">nc_cipherName</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-string">&quot;DES&quot;</span><span>
</span><a name="line-403"></a><span>	</span><span class="hs-identifier">nc_cipherKeySize</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">KeySizeFixed</span><span> </span><span class="hs-number">8</span><span>
</span><a name="line-404"></a><span>	</span><span class="hs-identifier">nc_ctx_size</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_des_ctx_size</span><span>
</span><a name="line-405"></a><span>	</span><span class="hs-identifier">nc_ctx</span><span>  </span><span class="hs-special">(</span><a name="local-8214565720323827383"><a href="Crypto.Nettle.Ciphers.Internal.html#nc_ctx"><span class="hs-identifier">DES</span></a></a><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Nettle.Ciphers.html#DES"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-406"></a><span>	</span><span class="hs-identifier">nc_Ctx</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">DES</span><span>
</span><a name="line-407"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleBlockCipher"><span class="hs-identifier hs-type">NettleBlockCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#DES"><span class="hs-identifier hs-type">DES</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-408"></a><span>	</span><span class="hs-identifier">nbc_blockSize</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-number">8</span><span>
</span><a name="line-409"></a><span>	</span><span class="hs-identifier">nbc_ecb_encrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_des_encrypt</span><span>
</span><a name="line-410"></a><span>	</span><span class="hs-identifier">nbc_ecb_decrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_des_decrypt</span><span>
</span><a name="line-411"></a><span>	</span><span class="hs-identifier">nbc_fun_encrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">p_des_encrypt</span><span>
</span><a name="line-412"></a><span>	</span><span class="hs-identifier">nbc_fun_decrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">p_des_decrypt</span><span>
</span><a name="line-413"></a><span>
</span><a name="line-414"></a><span class="hs-identifier">INSTANCE_BLOCKCIPHER</span><span class="hs-special">(</span><span class="hs-identifier">DES</span><span class="hs-special">)</span><span>
</span><a name="line-415"></a><span>
</span><a name="line-416"></a><span class="hs-comment">{-|
'DES_EDE3' uses 3 'DES' keys @k1 || k2 || k3@.
Encryption first encrypts with k1, then decrypts with k2, then encrypts with k3.

The 'blockSize' is the same as for 'DES': 64 bits (8 bytes),
and the keys are simply concatenated, forming a 24 byte key string (with 168 bits actually getting used).
-}</span><span>
</span><a name="line-423"></a><span class="hs-keyword">newtype</span><span> </span><a name="DES_EDE3"><a href="Crypto.Nettle.Ciphers.html#DES_EDE3"><span class="hs-identifier">DES_EDE3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="DES_EDE3"><a href="Crypto.Nettle.Ciphers.html#DES_EDE3"><span class="hs-identifier">DES_EDE3</span></a></a><span> </span><span class="hs-identifier hs-type">SecureMem</span><span>
</span><a name="line-424"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleCipher"><span class="hs-identifier hs-type">NettleCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#DES_EDE3"><span class="hs-identifier hs-type">DES_EDE3</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-425"></a><span>	</span><span class="hs-identifier">nc_cipherInit</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">ctxptr</span><span> </span><a name="local-6989586621679056755"><a href="#local-6989586621679056755"><span class="hs-identifier">_</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c_des3_set_key</span><span> </span><a href="Crypto.Nettle.Ciphers.ForeignImports.html#c_des3_set_key"><span class="hs-identifier hs-var">ctxptr</span></a><span>
</span><a name="line-426"></a><span>	</span><span class="hs-identifier">nc_cipherName</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-string">&quot;DES-EDE3&quot;</span><span>
</span><a name="line-427"></a><span>	</span><span class="hs-identifier">nc_cipherKeySize</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">KeySizeFixed</span><span> </span><span class="hs-number">24</span><span>
</span><a name="line-428"></a><span>	</span><span class="hs-identifier">nc_ctx_size</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_des3_ctx_size</span><span>
</span><a name="line-429"></a><span>	</span><span class="hs-identifier">nc_ctx</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">DES_EDE3</span><span> </span><a href="Crypto.Nettle.Ciphers.html#DES_EDE3"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Nettle.Ciphers.html#DES_EDE3"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-430"></a><span>	</span><span class="hs-identifier">nc_Ctx</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">DES_EDE3</span><span>
</span><a name="line-431"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleBlockCipher"><span class="hs-identifier hs-type">NettleBlockCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#DES_EDE3"><span class="hs-identifier hs-type">DES_EDE3</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-432"></a><span>	</span><span class="hs-identifier">nbc_blockSize</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-number">8</span><span>
</span><a name="line-433"></a><span>	</span><span class="hs-identifier">nbc_ecb_encrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_des3_encrypt</span><span>
</span><a name="line-434"></a><span>	</span><span class="hs-identifier">nbc_ecb_decrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_des3_decrypt</span><span>
</span><a name="line-435"></a><span>	</span><span class="hs-identifier">nbc_fun_encrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">p_des3_encrypt</span><span>
</span><a name="line-436"></a><span>	</span><span class="hs-identifier">nbc_fun_decrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">p_des3_decrypt</span><span>
</span><a name="line-437"></a><span>
</span><a name="line-438"></a><span class="hs-identifier">INSTANCE_BLOCKCIPHER</span><span class="hs-special">(</span><span class="hs-identifier">DES_EDE3</span><span class="hs-special">)</span><span>
</span><a name="line-439"></a><span>
</span><a name="line-440"></a><span class="hs-comment">{-|
'SERPENT' is one of the AES finalists, designed by Ross Anderson, Eli Biham and Lars Knudsen.

The 'blockSize' is 128 bits (16 bytes), and the valid key sizes are from 128 bits to 256 bits (16 to 32 bytes),
although smaller bits are just padded with zeroes.

'aeadInit' only supports the 'AEAD_GCM' mode for now.
-}</span><span>
</span><a name="line-448"></a><span class="hs-keyword">newtype</span><span> </span><a name="SERPENT"><a href="Crypto.Nettle.Ciphers.html#SERPENT"><span class="hs-identifier">SERPENT</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="SERPENT"><a href="Crypto.Nettle.Ciphers.html#SERPENT"><span class="hs-identifier">SERPENT</span></a></a><span> </span><span class="hs-identifier hs-type">SecureMem</span><span>
</span><a name="line-449"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleCipher"><span class="hs-identifier hs-type">NettleCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#SERPENT"><span class="hs-identifier hs-type">SERPENT</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-450"></a><span>	</span><span class="hs-identifier">nc_cipherInit</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_serpent_set_key</span><span>
</span><a name="line-451"></a><span>	</span><span class="hs-identifier">nc_cipherName</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-string">&quot;SERPENT&quot;</span><span>
</span><a name="line-452"></a><span>	</span><span class="hs-identifier">nc_cipherKeySize</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">KeySizeRange</span><span> </span><span class="hs-number">16</span><span> </span><span class="hs-number">32</span><span>
</span><a name="line-453"></a><span>	</span><span class="hs-identifier">nc_ctx_size</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_serpent_ctx_size</span><span>
</span><a name="line-454"></a><span>	</span><span class="hs-identifier">nc_ctx</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">SERPENT</span><span> </span><a href="Crypto.Nettle.Ciphers.html#SERPENT"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Nettle.Ciphers.html#SERPENT"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-455"></a><span>	</span><span class="hs-identifier">nc_Ctx</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">SERPENT</span><span>
</span><a name="line-456"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleBlockCipher"><span class="hs-identifier hs-type">NettleBlockCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#SERPENT"><span class="hs-identifier hs-type">SERPENT</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-457"></a><span>	</span><span class="hs-identifier">nbc_blockSize</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-number">16</span><span>
</span><a name="line-458"></a><span>	</span><span class="hs-identifier">nbc_ecb_encrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_serpent_encrypt</span><span>
</span><a name="line-459"></a><span>	</span><span class="hs-identifier">nbc_ecb_decrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_serpent_decrypt</span><span>
</span><a name="line-460"></a><span>	</span><span class="hs-identifier">nbc_fun_encrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">p_serpent_encrypt</span><span>
</span><a name="line-461"></a><span>	</span><span class="hs-identifier">nbc_fun_decrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">p_serpent_decrypt</span><span>
</span><a name="line-462"></a><span class="hs-identifier">INSTANCE_BLOCKCIPHER</span><span class="hs-special">(</span><span class="hs-identifier">SERPENT</span><span class="hs-special">)</span><span>
</span><a name="line-463"></a><span>
</span><a name="line-464"></a><span class="hs-comment">{-|
'TWOFISH' is another AES finalist, designed by Bruce Schneier and others.

'TWOFISH' uses a the same 'blockSize' and key sizes as 'AES'.

'aeadInit' only supports the 'AEAD_GCM' mode for now.
-}</span><span>
</span><a name="line-471"></a><span class="hs-keyword">newtype</span><span> </span><a name="TWOFISH"><a href="Crypto.Nettle.Ciphers.html#TWOFISH"><span class="hs-identifier">TWOFISH</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="TWOFISH"><a href="Crypto.Nettle.Ciphers.html#TWOFISH"><span class="hs-identifier">TWOFISH</span></a></a><span> </span><span class="hs-identifier hs-type">SecureMem</span><span>
</span><a name="line-472"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleCipher"><span class="hs-identifier hs-type">NettleCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#TWOFISH"><span class="hs-identifier hs-type">TWOFISH</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-473"></a><span>	</span><span class="hs-identifier">nc_cipherInit</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_twofish_set_key</span><span>
</span><a name="line-474"></a><span>	</span><span class="hs-identifier">nc_cipherName</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-string">&quot;TWOFISH&quot;</span><span>
</span><a name="line-475"></a><span>	</span><span class="hs-identifier">nc_cipherKeySize</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">KeySizeEnum</span><span> </span><span class="hs-special">[</span><span class="hs-number">16</span><span class="hs-special">,</span><span class="hs-number">24</span><span class="hs-special">,</span><span class="hs-number">32</span><span class="hs-special">]</span><span>
</span><a name="line-476"></a><span>	</span><span class="hs-identifier">nc_ctx_size</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_twofish_ctx_size</span><span>
</span><a name="line-477"></a><span>	</span><span class="hs-identifier">nc_ctx</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">TWOFISH</span><span> </span><a href="Crypto.Nettle.Ciphers.html#TWOFISH"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Nettle.Ciphers.html#TWOFISH"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-478"></a><span>	</span><span class="hs-identifier">nc_Ctx</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">TWOFISH</span><span>
</span><a name="line-479"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleBlockCipher"><span class="hs-identifier hs-type">NettleBlockCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#TWOFISH"><span class="hs-identifier hs-type">TWOFISH</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-480"></a><span>	</span><span class="hs-identifier">nbc_blockSize</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-number">16</span><span>
</span><a name="line-481"></a><span>	</span><span class="hs-identifier">nbc_ecb_encrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_twofish_encrypt</span><span>
</span><a name="line-482"></a><span>	</span><span class="hs-identifier">nbc_ecb_decrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_twofish_decrypt</span><span>
</span><a name="line-483"></a><span>	</span><span class="hs-identifier">nbc_fun_encrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">p_twofish_encrypt</span><span>
</span><a name="line-484"></a><span>	</span><span class="hs-identifier">nbc_fun_decrypt</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">p_twofish_decrypt</span><span>
</span><a name="line-485"></a><span class="hs-identifier">INSTANCE_BLOCKCIPHER</span><span class="hs-special">(</span><span class="hs-identifier">TWOFISH</span><span class="hs-special">)</span><span>
</span><a name="line-486"></a><span>
</span><a name="line-487"></a><span>
</span><a name="line-488"></a><span class="hs-comment">{-|
'ARCFOUR' is a stream cipher, also known under the trade marked name RC4.

Valid key sizes are from 1 to 256 bytes.
-}</span><span>
</span><a name="line-493"></a><span class="hs-keyword">newtype</span><span> </span><a name="ARCFOUR"><a href="Crypto.Nettle.Ciphers.html#ARCFOUR"><span class="hs-identifier">ARCFOUR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="ARCFOUR"><a href="Crypto.Nettle.Ciphers.html#ARCFOUR"><span class="hs-identifier">ARCFOUR</span></a></a><span> </span><span class="hs-identifier hs-type">SecureMem</span><span>
</span><a name="line-494"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleCipher"><span class="hs-identifier hs-type">NettleCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#ARCFOUR"><span class="hs-identifier hs-type">ARCFOUR</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-495"></a><span>	</span><span class="hs-identifier">nc_cipherInit</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_arcfour_set_key</span><span>
</span><a name="line-496"></a><span>	</span><span class="hs-identifier">nc_cipherName</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-string">&quot;ARCFOUR&quot;</span><span>
</span><a name="line-497"></a><span>	</span><span class="hs-identifier">nc_cipherKeySize</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">KeySizeEnum</span><span> </span><span class="hs-special">[</span><span class="hs-number">16</span><span class="hs-special">,</span><span class="hs-number">24</span><span class="hs-special">,</span><span class="hs-number">32</span><span class="hs-special">]</span><span>
</span><a name="line-498"></a><span>	</span><span class="hs-identifier">nc_ctx_size</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_arcfour_ctx_size</span><span>
</span><a name="line-499"></a><span>	</span><span class="hs-identifier">nc_ctx</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">ARCFOUR</span><span> </span><a href="Crypto.Nettle.Ciphers.html#ARCFOUR"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Nettle.Ciphers.html#ARCFOUR"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-500"></a><span>	</span><span class="hs-identifier">nc_Ctx</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ARCFOUR</span><span>
</span><a name="line-501"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleStreamCipher"><span class="hs-identifier hs-type">NettleStreamCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#ARCFOUR"><span class="hs-identifier hs-type">ARCFOUR</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-502"></a><span>	</span><span class="hs-identifier">nsc_streamCombine</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_arcfour_crypt</span><span>
</span><a name="line-503"></a><span class="hs-identifier">INSTANCE_STREAMCIPHER</span><span class="hs-special">(</span><span class="hs-identifier">ARCFOUR</span><span class="hs-special">)</span><span>
</span><a name="line-504"></a><span>
</span><a name="line-505"></a><span>
</span><a name="line-506"></a><span class="hs-comment">{-|
'StreamNonceCipher' are special stream ciphers that can encrypt many messages with the same key;
setting a nonce restarts the cipher.

A good value for the nonce is a message/packet counter. Usually a nonce should not be reused with the same key.
-}</span><span>
</span><a name="line-512"></a><span class="hs-keyword">class</span><span> </span><span class="hs-identifier hs-type">StreamCipher</span><span> </span><a href="#local-6989586621679056736"><span class="hs-identifier hs-type">cipher</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="StreamNonceCipher"><a href="Crypto.Nettle.Ciphers.html#StreamNonceCipher"><span class="hs-identifier">StreamNonceCipher</span></a></a><span> </span><a name="local-6989586621679056736"><a href="#local-6989586621679056736"><span class="hs-identifier">cipher</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-513"></a><span>	</span><span class="hs-identifier">streamNonceSize</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">cipher</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">KeySizeSpecifier</span><span>
</span><a name="line-514"></a><span>	</span><span class="hs-identifier">streamSetNonce</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">cipher</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056736"><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span></a><span class="hs-identifier">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-identifier">cipher</span><span>
</span><a name="line-515"></a><span>
</span><a name="line-516"></a><span class="hs-identifier">word64BE</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Word64</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-517"></a><a name="word64BE"><a href="Crypto.Nettle.Ciphers.html#word64BE"><span class="hs-identifier">word64BE</span></a></a><span> </span><a name="local-6989586621679056789"><a href="#local-6989586621679056789"><span class="hs-identifier">value</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">B</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679056790"><span class="hs-identifier hs-var">_work</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">8</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679056789"><span class="hs-identifier hs-var">value</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-518"></a><span>	</span><span class="hs-identifier">_work</span><span> </span><span class="hs-number">0</span><span> </span><a name="local-6989586621679056790"><a href="#local-6989586621679056790"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679056790"><a href="#local-6989586621679056790"><span class="hs-identifier">_</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">r</span><span>
</span><a name="line-519"></a><span>	</span><span class="hs-identifier">_work</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">d</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">shiftR</span><span class="hs-special">`</span><span> </span><span class="hs-number">8</span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">m</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-identifier hs-var">v</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Word8</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">_work</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056790"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">m</span><span class="hs-glyph">:</span><span class="hs-identifier hs-var">r</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">d</span><span>
</span><a name="line-520"></a><span>
</span><a name="line-521"></a><span class="hs-comment">{-|
Sets a 'Word64' as 8-byte nonce (bigendian encoded)
-}</span><span>
</span><a name="line-524"></a><span class="hs-identifier">streamSetNonceWord64</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Crypto.Nettle.Ciphers.html#StreamNonceCipher"><span class="hs-identifier hs-type">StreamNonceCipher</span></a><span> </span><a href="#local-6989586621679056782"><span class="hs-identifier hs-type">cipher</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679056782"><span class="hs-identifier hs-type">cipher</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Word64</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679056782"><span class="hs-identifier hs-type">cipher</span></a><span>
</span><a name="line-525"></a><a name="streamSetNonceWord64"><a href="Crypto.Nettle.Ciphers.html#streamSetNonceWord64"><span class="hs-identifier">streamSetNonceWord64</span></a></a><span> </span><a name="local-6989586621679056797"><a href="#local-6989586621679056797"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679056798"><a href="#local-6989586621679056798"><span class="hs-identifier">nonce</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Nettle.Ciphers.html#streamSetNonce"><span class="hs-identifier hs-var">streamSetNonce</span></a><span> </span><a href="#local-6989586621679056797"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Crypto.Nettle.Ciphers.html#word64BE"><span class="hs-identifier hs-var">word64BE</span></a><span> </span><a href="#local-6989586621679056798"><span class="hs-identifier hs-var">nonce</span></a><span>
</span><a name="line-526"></a><span>
</span><a name="line-527"></a><span class="hs-comment">-- set nonce to 0 on init</span><span>
</span><a name="line-528"></a><span class="hs-identifier">wrap_chacha_set_key</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-identifier hs-type">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Word</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-identifier hs-type">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-529"></a><a name="wrap_chacha_set_key"><a href="Crypto.Nettle.Ciphers.html#wrap_chacha_set_key"><span class="hs-identifier">wrap_chacha_set_key</span></a></a><span> </span><a name="local-6989586621679056799"><a href="#local-6989586621679056799"><span class="hs-identifier">ctxptr</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679056800"><a href="#local-6989586621679056800"><span class="hs-identifier">keyptr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-530"></a><span>	</span><span class="hs-identifier">c_chacha_set_key</span><span> </span><a href="Crypto.Nettle.Ciphers.ForeignImports.html#c_chacha_set_key"><span class="hs-identifier hs-var">ctxptr</span></a><span> </span><a href="#local-6989586621679056799"><span class="hs-identifier hs-var">keyptr</span></a><span>
</span><a name="line-531"></a><span>	</span><span class="hs-identifier">withByteStringPtr</span><span> </span><span class="hs-special">(</span><a href="Nettle.Utils.html#withByteStringPtr"><span class="hs-identifier hs-var">B</span><span class="hs-operator hs-var">.</span></a><span class="hs-identifier">replicate</span><span> </span><span class="hs-number">8</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">nonceptr</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-532"></a><span>		</span><span class="hs-identifier">c_chacha_set_nonce</span><span> </span><a href="Crypto.Nettle.Ciphers.ForeignImports.html#c_chacha_set_nonce"><span class="hs-identifier hs-var">ctxptr</span></a><span> </span><span class="hs-identifier">nonceptr</span><span>
</span><a name="line-533"></a><span>
</span><a name="line-534"></a><span class="hs-comment">-- check nonce length</span><span>
</span><a name="line-535"></a><span class="hs-identifier">wrap_chacha_set_nonce</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-identifier hs-type">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Word</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-identifier hs-type">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-536"></a><a name="wrap_chacha_set_nonce"><a href="Crypto.Nettle.Ciphers.html#wrap_chacha_set_nonce"><span class="hs-identifier">wrap_chacha_set_nonce</span></a></a><span> </span><a name="local-6989586621679056802"><a href="#local-6989586621679056802"><span class="hs-identifier">ctxptr</span></a></a><span> </span><a name="local-6989586621679056803"><a href="#local-6989586621679056803"><span class="hs-identifier">ivlen</span></a></a><span> </span><a name="local-6989586621679056804"><a href="#local-6989586621679056804"><span class="hs-identifier">ivptr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679056803"><span class="hs-identifier hs-var">ivlen</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">8</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="Crypto.Nettle.Ciphers.ForeignImports.html#c_chacha_set_nonce"><span class="hs-identifier hs-var">c_chacha_set_nonce</span></a><span> </span><a href="#local-6989586621679056802"><span class="hs-identifier hs-var">ctxptr</span></a><span> </span><a href="#local-6989586621679056804"><span class="hs-identifier hs-var">ivptr</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">fail</span><span> </span><span class="hs-string">&quot;Invalid nonce length&quot;</span><span>
</span><a name="line-537"></a><span>
</span><a name="line-538"></a><span class="hs-comment">{-|
'CHACHA' is a variant of the 'SALSA20' stream cipher, both designed by D. J. Bernstein.

Key size is 256 bits (32 bytes).

'CHACHA' works similar to 'SALSA20'; it could theoretically also support 128-bit keys, but there is no need for it as they share the same performance.

ChaCha uses a blocksize of 64 bytes internally; if crpyted input isn't aligned to 64 bytes it will
pad it with 0 and store the encrypted padding to xor with future input data.

Each message also requires a 8-byte ('Word64') nonce (which is initialized to 0; you can use a message sequence number).
Don't reuse a nonce with the same key.

Setting a nonce also resets the remaining padding data.
-}</span><span>
</span><a name="line-553"></a><span class="hs-keyword">newtype</span><span> </span><a name="CHACHA"><a href="Crypto.Nettle.Ciphers.html#CHACHA"><span class="hs-identifier">CHACHA</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="CHACHA"><a href="Crypto.Nettle.Ciphers.html#CHACHA"><span class="hs-identifier">CHACHA</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">SecureMem</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span class="hs-special">)</span><span>
</span><a name="line-554"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleCipher"><span class="hs-identifier hs-type">NettleCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#CHACHA"><span class="hs-identifier hs-type">CHACHA</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-555"></a><span>	</span><span class="hs-identifier">nc_cipherInit</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">wrap_chacha_set_key</span><span>
</span><a name="line-556"></a><span>	</span><span class="hs-identifier">nc_cipherName</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-string">&quot;ChaCha&quot;</span><span>
</span><a name="line-557"></a><span>	</span><span class="hs-identifier">nc_cipherKeySize</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">KeySizeFixed</span><span> </span><span class="hs-number">32</span><span>
</span><a name="line-558"></a><span>	</span><span class="hs-identifier">nc_ctx_size</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_chacha_ctx_size</span><span>
</span><a name="line-559"></a><span>	</span><span class="hs-identifier">nc_ctx</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">CHACHA</span><span> </span><span class="hs-special">(</span><a href="Crypto.Nettle.Ciphers.html#CHACHA"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><span> </span><a href="Crypto.Nettle.Ciphers.html#CHACHA"><span class="hs-identifier hs-var">_</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-560"></a><span>	</span><span class="hs-identifier">nc_Ctx</span><span> </span><a name="local-8214565720323827384"><a href="Crypto.Nettle.Ciphers.Internal.html#nc_Ctx"><span class="hs-identifier">c</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">CHACHA</span><span> </span><span class="hs-special">(</span><a href="Crypto.Nettle.Ciphers.html#CHACHA"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><span> </span><a href="Crypto.Nettle.Ciphers.html#CHACHA"><span class="hs-identifier hs-var">B</span><span class="hs-operator hs-var">.</span></a><span class="hs-identifier">empty</span><span class="hs-special">)</span><span>
</span><a name="line-561"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleBlockedStreamCipher"><span class="hs-identifier hs-type">NettleBlockedStreamCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#CHACHA"><span class="hs-identifier hs-type">CHACHA</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-562"></a><span>	</span><span class="hs-identifier">nbsc_blockSize</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-number">64</span><span>
</span><a name="line-563"></a><span>	</span><span class="hs-identifier">nbsc_IncompleteState</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">CHACHA</span><span> </span><span class="hs-special">(</span><a href="Crypto.Nettle.Ciphers.html#CHACHA"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><span> </span><a href="Crypto.Nettle.Ciphers.html#CHACHA"><span class="hs-identifier hs-var">_</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">inc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">CHACHA</span><span> </span><span class="hs-special">(</span><a href="Crypto.Nettle.Ciphers.html#CHACHA"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">inc</span><span class="hs-special">)</span><span>
</span><a name="line-564"></a><span>	</span><span class="hs-identifier">nbsc_incompleteState</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">CHACHA</span><span> </span><span class="hs-special">(</span><a href="Crypto.Nettle.Ciphers.html#CHACHA"><span class="hs-identifier hs-var">_</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">inc</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">inc</span><span>
</span><a name="line-565"></a><span>	</span><span class="hs-identifier">nbsc_streamCombine</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_chacha_crypt</span><span>
</span><a name="line-566"></a><span>	</span><span class="hs-identifier">nbsc_nonceSize</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">KeySizeFixed</span><span> </span><span class="hs-number">8</span><span>
</span><a name="line-567"></a><span>	</span><span class="hs-identifier">nbsc_setNonce</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier">wrap_chacha_set_nonce</span><span>
</span><a name="line-568"></a><span class="hs-identifier">INSTANCE_BLOCKEDSTREAMNONCECIPHER</span><span class="hs-special">(</span><a name="local-8214565720323791129"><span class="hs-identifier">CHACHA</span></a><span class="hs-special">)</span><span>
</span><a name="line-569"></a><span>
</span><a name="line-570"></a><span class="hs-comment">-- set nonce to 0 on init</span><span>
</span><a name="line-571"></a><span class="hs-identifier">wrap_salsa20_set_key</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-identifier hs-type">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Word</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-identifier hs-type">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-572"></a><a name="wrap_salsa20_set_key"><a href="Crypto.Nettle.Ciphers.html#wrap_salsa20_set_key"><span class="hs-identifier">wrap_salsa20_set_key</span></a></a><span> </span><a name="local-6989586621679056805"><a href="#local-6989586621679056805"><span class="hs-identifier">ctxptr</span></a></a><span> </span><a name="local-6989586621679056806"><a href="#local-6989586621679056806"><span class="hs-identifier">keylen</span></a></a><span> </span><a name="local-6989586621679056807"><a href="#local-6989586621679056807"><span class="hs-identifier">keyptr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-573"></a><span>	</span><span class="hs-identifier">c_salsa20_set_key</span><span> </span><a href="Crypto.Nettle.Ciphers.ForeignImports.html#c_salsa20_set_key"><span class="hs-identifier hs-var">ctxptr</span></a><span> </span><a href="#local-6989586621679056805"><span class="hs-identifier hs-var">keylen</span></a><span> </span><a href="#local-6989586621679056806"><span class="hs-identifier hs-var">keyptr</span></a><span>
</span><a name="line-574"></a><span>	</span><span class="hs-identifier">withByteStringPtr</span><span> </span><span class="hs-special">(</span><a href="Nettle.Utils.html#withByteStringPtr"><span class="hs-identifier hs-var">B</span><span class="hs-operator hs-var">.</span></a><span class="hs-identifier">replicate</span><span> </span><span class="hs-number">8</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">nonceptr</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-575"></a><span>		</span><span class="hs-identifier">c_salsa20_set_nonce</span><span> </span><a href="Crypto.Nettle.Ciphers.ForeignImports.html#c_salsa20_set_nonce"><span class="hs-identifier hs-var">ctxptr</span></a><span> </span><span class="hs-identifier">nonceptr</span><span>
</span><a name="line-576"></a><span>
</span><a name="line-577"></a><span class="hs-comment">-- check nonce length</span><span>
</span><a name="line-578"></a><span class="hs-identifier">wrap_salsa20_set_nonce</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-identifier hs-type">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Word</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-identifier hs-type">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-579"></a><a name="wrap_salsa20_set_nonce"><a href="Crypto.Nettle.Ciphers.html#wrap_salsa20_set_nonce"><span class="hs-identifier">wrap_salsa20_set_nonce</span></a></a><span> </span><a name="local-6989586621679056809"><a href="#local-6989586621679056809"><span class="hs-identifier">ctxptr</span></a></a><span> </span><a name="local-6989586621679056810"><a href="#local-6989586621679056810"><span class="hs-identifier">ivlen</span></a></a><span> </span><a name="local-6989586621679056811"><a href="#local-6989586621679056811"><span class="hs-identifier">ivptr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679056810"><span class="hs-identifier hs-var">ivlen</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">8</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="Crypto.Nettle.Ciphers.ForeignImports.html#c_salsa20_set_nonce"><span class="hs-identifier hs-var">c_salsa20_set_nonce</span></a><span> </span><a href="#local-6989586621679056809"><span class="hs-identifier hs-var">ctxptr</span></a><span> </span><a href="#local-6989586621679056811"><span class="hs-identifier hs-var">ivptr</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">fail</span><span> </span><span class="hs-string">&quot;Invalid nonce length&quot;</span><span>
</span><a name="line-580"></a><span>
</span><a name="line-581"></a><span class="hs-comment">{-|
'SALSA20' is a fairly recent stream cipher designed by D. J. Bernstein.

Valid key sizes are 128 and 256 bits (16 and 32 bytes).

Salsa20 uses a blocksize of 64 bytes internally; if crpyted input isn't aligned to 64 bytes it will
pad it with 0 and store the encrypted padding to xor with future input data.

Each message also requires a 8-byte ('Word64') nonce (which is initialized to 0; you can use a message sequence number).
Don't reuse a nonce with the same key.

Setting a nonce also resets the remaining padding data.
-}</span><span>
</span><a name="line-594"></a><span class="hs-keyword">newtype</span><span> </span><a name="SALSA20"><a href="Crypto.Nettle.Ciphers.html#SALSA20"><span class="hs-identifier">SALSA20</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="SALSA20"><a href="Crypto.Nettle.Ciphers.html#SALSA20"><span class="hs-identifier">SALSA20</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">SecureMem</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span class="hs-special">)</span><span>
</span><a name="line-595"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleCipher"><span class="hs-identifier hs-type">NettleCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#SALSA20"><span class="hs-identifier hs-type">SALSA20</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-596"></a><span>	</span><span class="hs-identifier">nc_cipherInit</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">wrap_salsa20_set_key</span><span>
</span><a name="line-597"></a><span>	</span><span class="hs-identifier">nc_cipherName</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-string">&quot;Salsa20&quot;</span><span>
</span><a name="line-598"></a><span>	</span><span class="hs-identifier">nc_cipherKeySize</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">KeySizeEnum</span><span> </span><span class="hs-special">[</span><span class="hs-number">16</span><span class="hs-special">,</span><span class="hs-number">32</span><span class="hs-special">]</span><span>
</span><a name="line-599"></a><span>	</span><span class="hs-identifier">nc_ctx_size</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_salsa20_ctx_size</span><span>
</span><a name="line-600"></a><span>	</span><span class="hs-identifier">nc_ctx</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SALSA20</span><span> </span><span class="hs-special">(</span><a href="Crypto.Nettle.Ciphers.html#SALSA20"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><span> </span><a href="Crypto.Nettle.Ciphers.html#SALSA20"><span class="hs-identifier hs-var">_</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-601"></a><span>	</span><span class="hs-identifier">nc_Ctx</span><span> </span><a name="local-8214565720323827384"><a href="Crypto.Nettle.Ciphers.Internal.html#nc_Ctx"><span class="hs-identifier">c</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">SALSA20</span><span> </span><span class="hs-special">(</span><a href="Crypto.Nettle.Ciphers.html#SALSA20"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><span> </span><a href="Crypto.Nettle.Ciphers.html#SALSA20"><span class="hs-identifier hs-var">B</span><span class="hs-operator hs-var">.</span></a><span class="hs-identifier">empty</span><span class="hs-special">)</span><span>
</span><a name="line-602"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleBlockedStreamCipher"><span class="hs-identifier hs-type">NettleBlockedStreamCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#SALSA20"><span class="hs-identifier hs-type">SALSA20</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-603"></a><span>	</span><span class="hs-identifier">nbsc_blockSize</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-number">64</span><span>
</span><a name="line-604"></a><span>	</span><span class="hs-identifier">nbsc_IncompleteState</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SALSA20</span><span> </span><span class="hs-special">(</span><a href="Crypto.Nettle.Ciphers.html#SALSA20"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><span> </span><a href="Crypto.Nettle.Ciphers.html#SALSA20"><span class="hs-identifier hs-var">_</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">inc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">SALSA20</span><span> </span><span class="hs-special">(</span><a href="Crypto.Nettle.Ciphers.html#SALSA20"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">inc</span><span class="hs-special">)</span><span>
</span><a name="line-605"></a><span>	</span><span class="hs-identifier">nbsc_incompleteState</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SALSA20</span><span> </span><span class="hs-special">(</span><a href="Crypto.Nettle.Ciphers.html#SALSA20"><span class="hs-identifier hs-var">_</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">inc</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">inc</span><span>
</span><a name="line-606"></a><span>	</span><span class="hs-identifier">nbsc_streamCombine</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_salsa20_crypt</span><span>
</span><a name="line-607"></a><span>	</span><span class="hs-identifier">nbsc_nonceSize</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">KeySizeFixed</span><span> </span><span class="hs-number">8</span><span>
</span><a name="line-608"></a><span>	</span><span class="hs-identifier">nbsc_setNonce</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier">wrap_salsa20_set_nonce</span><span>
</span><a name="line-609"></a><span class="hs-identifier">INSTANCE_BLOCKEDSTREAMNONCECIPHER</span><span class="hs-special">(</span><a name="local-8214565720323791129"><span class="hs-identifier">SALSA20</span></a><span class="hs-special">)</span><span>
</span><a name="line-610"></a><span>
</span><a name="line-611"></a><span>
</span><a name="line-612"></a><span class="hs-comment">{-|
'ESTREAM_SALSA20' is the same as 'SALSA20', but uses only 12 instead of 20 rounds in mixing.
-}</span><span>
</span><a name="line-615"></a><span class="hs-keyword">newtype</span><span> </span><a name="ESTREAM_SALSA20"><a href="Crypto.Nettle.Ciphers.html#ESTREAM_SALSA20"><span class="hs-identifier">ESTREAM_SALSA20</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="ESTREAM_SALSA20"><a href="Crypto.Nettle.Ciphers.html#ESTREAM_SALSA20"><span class="hs-identifier">ESTREAM_SALSA20</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">SecureMem</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span class="hs-special">)</span><span>
</span><a name="line-616"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleCipher"><span class="hs-identifier hs-type">NettleCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#ESTREAM_SALSA20"><span class="hs-identifier hs-type">ESTREAM_SALSA20</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-617"></a><span>	</span><span class="hs-identifier">nc_cipherInit</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">wrap_salsa20_set_key</span><span>
</span><a name="line-618"></a><span>	</span><span class="hs-identifier">nc_cipherName</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-string">&quot;eSTREAM-Salsa20&quot;</span><span>
</span><a name="line-619"></a><span>	</span><span class="hs-identifier">nc_cipherKeySize</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">KeySizeEnum</span><span> </span><span class="hs-special">[</span><span class="hs-number">16</span><span class="hs-special">,</span><span class="hs-number">32</span><span class="hs-special">]</span><span>
</span><a name="line-620"></a><span>	</span><span class="hs-identifier">nc_ctx_size</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_salsa20_ctx_size</span><span>
</span><a name="line-621"></a><span>	</span><span class="hs-identifier">nc_ctx</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ESTREAM_SALSA20</span><span> </span><span class="hs-special">(</span><a href="Crypto.Nettle.Ciphers.html#ESTREAM_SALSA20"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><span> </span><a href="Crypto.Nettle.Ciphers.html#ESTREAM_SALSA20"><span class="hs-identifier hs-var">_</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-622"></a><span>	</span><span class="hs-identifier">nc_Ctx</span><span> </span><a name="local-8214565720323827384"><a href="Crypto.Nettle.Ciphers.Internal.html#nc_Ctx"><span class="hs-identifier">c</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ESTREAM_SALSA20</span><span> </span><span class="hs-special">(</span><a href="Crypto.Nettle.Ciphers.html#ESTREAM_SALSA20"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><span> </span><a href="Crypto.Nettle.Ciphers.html#ESTREAM_SALSA20"><span class="hs-identifier hs-var">B</span><span class="hs-operator hs-var">.</span></a><span class="hs-identifier">empty</span><span class="hs-special">)</span><span>
</span><a name="line-623"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Ciphers.Internal.html#NettleBlockedStreamCipher"><span class="hs-identifier hs-type">NettleBlockedStreamCipher</span></a><span> </span><a href="Crypto.Nettle.Ciphers.html#ESTREAM_SALSA20"><span class="hs-identifier hs-type">ESTREAM_SALSA20</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-624"></a><span>	</span><span class="hs-identifier">nbsc_blockSize</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-number">64</span><span>
</span><a name="line-625"></a><span>	</span><span class="hs-identifier">nbsc_IncompleteState</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ESTREAM_SALSA20</span><span> </span><span class="hs-special">(</span><a href="Crypto.Nettle.Ciphers.html#ESTREAM_SALSA20"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><span> </span><a href="Crypto.Nettle.Ciphers.html#ESTREAM_SALSA20"><span class="hs-identifier hs-var">_</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">inc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ESTREAM_SALSA20</span><span> </span><span class="hs-special">(</span><a href="Crypto.Nettle.Ciphers.html#ESTREAM_SALSA20"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">inc</span><span class="hs-special">)</span><span>
</span><a name="line-626"></a><span>	</span><span class="hs-identifier">nbsc_incompleteState</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ESTREAM_SALSA20</span><span> </span><span class="hs-special">(</span><a href="Crypto.Nettle.Ciphers.html#ESTREAM_SALSA20"><span class="hs-identifier hs-var">_</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">inc</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">inc</span><span>
</span><a name="line-627"></a><span>	</span><span class="hs-identifier">nbsc_streamCombine</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier">c_salsa20r12_crypt</span><span>
</span><a name="line-628"></a><span>	</span><span class="hs-identifier">nbsc_nonceSize</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">KeySizeFixed</span><span> </span><span class="hs-number">8</span><span>
</span><a name="line-629"></a><span>	</span><span class="hs-identifier">nbsc_setNonce</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier">wrap_salsa20_set_nonce</span><span>
</span><a name="line-630"></a><span class="hs-identifier">INSTANCE_BLOCKEDSTREAMNONCECIPHER</span><span class="hs-special">(</span><span class="hs-identifier">ESTREAM_SALSA20</span><span class="hs-special">)</span><span>
</span><a name="line-631"></a></pre></body></html>