<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ExistentialQuantification, MultiParamTypeClasses #-}</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-4"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-5"></a><span class="hs-comment">-- Module      :  Crypto.Nettle.Hash.Types</span><span>
</span><a name="line-6"></a><span class="hs-comment">-- Copyright   :  (c) 2013 Stefan B&#252;hler</span><span>
</span><a name="line-7"></a><span class="hs-comment">-- License     :  MIT-style (see the file COPYING)</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- </span><span>
</span><a name="line-9"></a><span class="hs-comment">-- Maintainer  :  stbuehler@web.de</span><span>
</span><a name="line-10"></a><span class="hs-comment">-- Stability   :  experimental</span><span>
</span><a name="line-11"></a><span class="hs-comment">-- Portability :  portable</span><span>
</span><a name="line-12"></a><span class="hs-comment">--</span><span>
</span><a name="line-13"></a><span class="hs-comment">-- Collection of internal types due to cyclic dependencies</span><span>
</span><a name="line-14"></a><span class="hs-comment">--</span><span>
</span><a name="line-15"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-16"></a><span>
</span><a name="line-17"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Crypto</span><span class="hs-operator">.</span><span class="hs-identifier">Nettle</span><span class="hs-operator">.</span><span class="hs-identifier">Hash</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span><span>
</span><a name="line-18"></a><span>	</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">HashAlgorithm</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-19"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hash</span><span>
</span><a name="line-20"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hash'</span><span>
</span><a name="line-21"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hashLazy</span><span>
</span><a name="line-22"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hashLazy'</span><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">KeyedHashAlgorithm</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-25"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">KeyedHash</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-26"></a><span>
</span><a name="line-27"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">keyedHashDigestSize</span><span>
</span><a name="line-28"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">keyedHashDigestSize'</span><span>
</span><a name="line-29"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">keyedHashName</span><span>
</span><a name="line-30"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">keyedHashName'</span><span>
</span><a name="line-31"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">keyedHashInit</span><span>
</span><a name="line-32"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">keyedHashInit'</span><span>
</span><a name="line-33"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">keyedHashUpdate</span><span>
</span><a name="line-34"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">keyedHashUpdateLazy</span><span>
</span><a name="line-35"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">keyedHashFinalize</span><span>
</span><a name="line-36"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">keyedHash</span><span>
</span><a name="line-37"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">keyedHash'</span><span>
</span><a name="line-38"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">keyedHashLazy</span><span>
</span><a name="line-39"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">keyedHashLazy'</span><span>
</span><a name="line-40"></a><span>
</span><a name="line-41"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Tagged</span><span>
</span><a name="line-42"></a><span>
</span><a name="line-43"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">HMAC</span><span>
</span><a name="line-44"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hmacInit</span><span>
</span><a name="line-45"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hmacInit'</span><span>
</span><a name="line-46"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hmac</span><span>
</span><a name="line-47"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hmac'</span><span>
</span><a name="line-48"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hmacLazy</span><span>
</span><a name="line-49"></a><span>	</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hmacLazy'</span><span>
</span><a name="line-50"></a><span>	</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Tagged</span><span>
</span><a name="line-53"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">ByteString</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">B</span><span>
</span><a name="line-54"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">ByteString</span><span class="hs-operator">.</span><span class="hs-identifier">Lazy</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">L</span><span>
</span><a name="line-55"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Applicative</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;$&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-56"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Bits</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">xor</span><span class="hs-special">)</span><span>
</span><a name="line-57"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">foldl'</span><span class="hs-special">)</span><span>
</span><a name="line-58"></a><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span class="hs-comment">{-|
'HashAlgorithm' is a class that hash algorithms will implement. generating a digest is a 3 step procedure:

  * 'hashInit' to create a new context

  * 'hashUpdate' to hash data

  * 'hashFinalize' to extract the final digest

The final digest has 'hashDigestSize' bytes, and the algorithm uses 'hashBlockSize' as internal block size.
-}</span><span>
</span><a name="line-71"></a><span class="hs-keyword">class</span><span> </span><a name="HashAlgorithm"><a href="Crypto.Nettle.Hash.Types.html#HashAlgorithm"><span class="hs-identifier">HashAlgorithm</span></a></a><span> </span><a name="local-6989586621679025060"><a href="#local-6989586621679025060"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-72"></a><span>	</span><span class="hs-comment">-- | Block size in bytes the hash algorithm operates on</span><span>
</span><a name="line-73"></a><span>	</span><span class="hs-identifier">hashBlockSize</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier hs-type">a</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-74"></a><span>	</span><span class="hs-comment">-- | Digest size in bytes the hash algorithm returns</span><span>
</span><a name="line-75"></a><span>	</span><span class="hs-identifier">hashDigestSize</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier hs-type">a</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-76"></a><span>	</span><span class="hs-comment">-- | Name of the hash algorithm</span><span>
</span><a name="line-77"></a><span>	</span><span class="hs-identifier">hashName</span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier hs-type">a</span><span> </span><span class="hs-identifier">String</span><span>
</span><a name="line-78"></a><span>	</span><span class="hs-comment">-- | Initialize a new context for this hash algorithm</span><span>
</span><a name="line-79"></a><span>	</span><span class="hs-identifier">hashInit</span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-80"></a><span>	</span><span class="hs-comment">-- | Update the context with bytestring, and return a new context with the updates.</span><span>
</span><a name="line-81"></a><span>	</span><span class="hs-identifier">hashUpdate</span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">B</span><span class="hs-operator">.</span><span class="hs-identifier">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">a</span><span>
</span><a name="line-82"></a><span>	</span><span class="hs-comment">-- | Update the context with a lazy bytestring, and return a new context with the updates.</span><span>
</span><a name="line-83"></a><span>	</span><span class="hs-identifier">hashUpdateLazy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">L</span><span class="hs-operator">.</span><span class="hs-identifier">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">a</span><span>
</span><a name="line-84"></a><span>	</span><span class="hs-identifier">hashUpdateLazy</span><span> </span><a name="local-8214565720323796694"><a href="Crypto.Nettle.Hash.Types.html#hashUpdateLazy"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldl'</span><span> </span><span class="hs-identifier">hashUpdate</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#hashUpdate"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="Crypto.Nettle.Hash.Types.html#hashUpdate"><span class="hs-operator hs-var">.</span></a><span> </span><a href="Crypto.Nettle.Hash.Types.html#hashUpdate"><span class="hs-identifier hs-var">L</span><span class="hs-operator hs-var">.</span></a><span class="hs-identifier">toChunks</span><span>
</span><a name="line-85"></a><span>	</span><span class="hs-comment">-- | Finalize a context and return a digest.</span><span>
</span><a name="line-86"></a><span>	</span><span class="hs-identifier">hashFinalize</span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">B</span><span class="hs-operator">.</span><span class="hs-identifier">ByteString</span><span>
</span><a name="line-87"></a><span>	</span><span class="hs-comment">-- | Use 'HashAlgorithm' for HMAC; can use a optimized variant or the default 'hmacInit' one</span><span>
</span><a name="line-88"></a><span>	</span><span class="hs-identifier">hashHMAC</span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">B</span><span class="hs-operator">.</span><span class="hs-identifier">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier hs-type">a</span><span> </span><span class="hs-identifier">KeyedHash</span><span>
</span><a name="line-89"></a><span>	</span><span class="hs-identifier">hashHMAC</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">hmacInit</span><span>
</span><a name="line-90"></a><span>
</span><a name="line-91"></a><span class="hs-comment">{-|
Helper to hash a single (strict) 'B.ByteString' in one step.

Example:

&gt; untag (hash (fromString &quot;abc&quot;) :: Tagged SHA256 B.ByteString)
-}</span><span>
</span><a name="line-98"></a><span class="hs-identifier">hash</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a><span> </span><a href="#local-6989586621679028988"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Tagged</span><span> </span><a href="#local-6989586621679028988"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-99"></a><a name="hash"><a href="Crypto.Nettle.Hash.Types.html#hash"><span class="hs-identifier">hash</span></a></a><span> </span><a name="local-6989586621679028989"><a href="#local-6989586621679028989"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#hashFinalize"><span class="hs-identifier hs-var">hashFinalize</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#hashUpdate"><span class="hs-identifier hs-var">hashUpdate</span></a><span> </span><a href="#local-6989586621679028989"><span class="hs-identifier hs-var">msg</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">tagSelf</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#hashInit"><span class="hs-identifier hs-var">hashInit</span></a><span>
</span><a name="line-100"></a><span class="hs-comment">{-|
Untagged variant of 'hash'; takes a (possible 'undefined') typed 'HashAlgorithm' context as parameter.

Example:

&gt; hash' (undefined :: SHA256) $ fromString &quot;abc&quot;
-}</span><span>
</span><a name="line-107"></a><span class="hs-identifier">hash'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a><span> </span><a href="#local-6989586621679028987"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679028987"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-108"></a><a name="hash%27"><a href="Crypto.Nettle.Hash.Types.html#hash%27"><span class="hs-identifier">hash'</span></a></a><span> </span><a name="local-6989586621679028990"><a href="#local-6989586621679028990"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier hs-var">witness</span><span> </span><a href="#local-6989586621679028990"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#hash"><span class="hs-identifier hs-var">hash</span></a><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><span class="hs-comment">{-|
Helper to hash a single (lazy) 'L.ByteString' in one step.

Example:

&gt; untag (hashLazy (fromString &quot;abc&quot;) :: Tagged SHA256 L.ByteString)
-}</span><span>
</span><a name="line-117"></a><span class="hs-identifier">hashLazy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a><span> </span><a href="#local-6989586621679028986"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">L</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Tagged</span><span> </span><a href="#local-6989586621679028986"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-identifier hs-type">L</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-118"></a><a name="hashLazy"><a href="Crypto.Nettle.Hash.Types.html#hashLazy"><span class="hs-identifier">hashLazy</span></a></a><span> </span><a name="local-6989586621679028991"><a href="#local-6989586621679028991"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">L</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromStrict</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#hashFinalize"><span class="hs-identifier hs-var">hashFinalize</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#hashUpdateLazy"><span class="hs-identifier hs-var">hashUpdateLazy</span></a><span> </span><a href="#local-6989586621679028991"><span class="hs-identifier hs-var">msg</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">tagSelf</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#hashInit"><span class="hs-identifier hs-var">hashInit</span></a><span>
</span><a name="line-119"></a><span class="hs-comment">{-|
Untagged variant of 'hashLazy'; takes a (possible 'undefined') typed 'HashAlgorithm' context as parameter.

Example:

&gt; hashLazy' (undefined :: SHA256) $ fromString &quot;abc&quot;
-}</span><span>
</span><a name="line-126"></a><span class="hs-identifier">hashLazy'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a><span> </span><a href="#local-6989586621679028985"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679028985"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">L</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">L</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-127"></a><a name="hashLazy%27"><a href="Crypto.Nettle.Hash.Types.html#hashLazy%27"><span class="hs-identifier">hashLazy'</span></a></a><span> </span><a name="local-6989586621679028992"><a href="#local-6989586621679028992"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier hs-var">witness</span><span> </span><a href="#local-6989586621679028992"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#hashLazy"><span class="hs-identifier hs-var">hashLazy</span></a><span>
</span><a name="line-128"></a><span>
</span><a name="line-129"></a><span class="hs-comment">{-|
'KeyedHashAlgorithm' is a class for keyed hash algorithms that take a key and a message to produce a digest.
The most popular example is 'HMAC'.
-}</span><span>
</span><a name="line-133"></a><span class="hs-keyword">class</span><span> </span><a name="KeyedHashAlgorithm"><a href="Crypto.Nettle.Hash.Types.html#KeyedHashAlgorithm"><span class="hs-identifier">KeyedHashAlgorithm</span></a></a><span> </span><a name="local-6989586621679021812"><a href="#local-6989586621679021812"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-134"></a><span>	</span><span class="hs-comment">-- | Digest size in bytes the keyed hash algorithm returns</span><span>
</span><a name="line-135"></a><span>	</span><span class="hs-identifier">implKeyedHashDigestSize</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier hs-type">k</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-136"></a><span>	</span><span class="hs-comment">-- | Name</span><span>
</span><a name="line-137"></a><span>	</span><span class="hs-identifier">implKeyedHashName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier hs-type">k</span><span> </span><span class="hs-identifier">String</span><span>
</span><a name="line-138"></a><span>	</span><span class="hs-comment">-- | Initialize state from a key</span><span>
</span><a name="line-139"></a><span>	</span><span class="hs-identifier">implKeyedHashInit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">B</span><span class="hs-operator">.</span><span class="hs-identifier">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">k</span><span>
</span><a name="line-140"></a><span>	</span><span class="hs-comment">-- | Add more message data to the state</span><span>
</span><a name="line-141"></a><span>	</span><span class="hs-identifier">implKeyedHashUpdate</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">k</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">B</span><span class="hs-operator">.</span><span class="hs-identifier">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">k</span><span>
</span><a name="line-142"></a><span>	</span><span class="hs-comment">-- | Add more lazy message data to the state</span><span>
</span><a name="line-143"></a><span>	</span><span class="hs-identifier">implKeyedHashUpdateLazy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">k</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">L</span><span class="hs-operator">.</span><span class="hs-identifier">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">k</span><span>
</span><a name="line-144"></a><span>	</span><span class="hs-identifier">implKeyedHashUpdateLazy</span><span> </span><a name="local-8214565720323796686"><a href="Crypto.Nettle.Hash.Types.html#implKeyedHashUpdateLazy"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldl'</span><span> </span><span class="hs-identifier">implKeyedHashUpdate</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#implKeyedHashUpdate"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="Crypto.Nettle.Hash.Types.html#implKeyedHashUpdate"><span class="hs-operator hs-var">.</span></a><span> </span><a href="Crypto.Nettle.Hash.Types.html#implKeyedHashUpdate"><span class="hs-identifier hs-var">L</span><span class="hs-operator hs-var">.</span></a><span class="hs-identifier">toChunks</span><span>
</span><a name="line-145"></a><span>	</span><span class="hs-comment">-- | Produce final digest</span><span>
</span><a name="line-146"></a><span>	</span><span class="hs-identifier">implKeyedHashFinalize</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">k</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">B</span><span class="hs-operator">.</span><span class="hs-identifier">ByteString</span><span>
</span><a name="line-147"></a><span>
</span><a name="line-148"></a><span class="hs-comment">{-|
'KeyedHash' hides the 'KeyedHashAlgorithm' implementation.
-}</span><span>
</span><a name="line-151"></a><span class="hs-keyword">data</span><span> </span><a name="KeyedHash"><a href="Crypto.Nettle.Hash.Types.html#KeyedHash"><span class="hs-identifier">KeyedHash</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679021811"><a href="#local-6989586621679021811"><span class="hs-identifier">k</span></a></a><span class="hs-operator">.</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#KeyedHashAlgorithm"><span class="hs-identifier hs-type">KeyedHashAlgorithm</span></a><span> </span><a href="#local-6989586621679021811"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="KeyedHash"><a href="Crypto.Nettle.Hash.Types.html#KeyedHash"><span class="hs-identifier">KeyedHash</span></a></a><span> </span><span class="hs-glyph">!</span><a href="#local-6989586621679021811"><span class="hs-identifier hs-type">k</span></a><span>
</span><a name="line-152"></a><span>
</span><a name="line-153"></a><span class="hs-comment">{-|
Untagged variant of 'implKeyedHashDigestSize'; takes a (possible 'undefined') key typed value from a 'KeyedHashAlgorithm' instance as parameter.
-}</span><span>
</span><a name="line-156"></a><span class="hs-identifier">keyedHashDigestSize</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#KeyedHashAlgorithm"><span class="hs-identifier hs-type">KeyedHashAlgorithm</span></a><span> </span><a href="#local-6989586621679028984"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679028984"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-157"></a><a name="keyedHashDigestSize"><a href="Crypto.Nettle.Hash.Types.html#keyedHashDigestSize"><span class="hs-identifier">keyedHashDigestSize</span></a></a><span> </span><a name="local-6989586621679028993"><a href="#local-6989586621679028993"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#implKeyedHashDigestSize"><span class="hs-identifier hs-var">implKeyedHashDigestSize</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">witness</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679028993"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-158"></a><span class="hs-comment">{-|
Get 'implKeyedHashDigestSize' from a 'KeyedHash'
-}</span><span>
</span><a name="line-161"></a><span class="hs-identifier">keyedHashDigestSize'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#KeyedHash"><span class="hs-identifier hs-type">KeyedHash</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-162"></a><a name="keyedHashDigestSize%27"><a href="Crypto.Nettle.Hash.Types.html#keyedHashDigestSize%27"><span class="hs-identifier">keyedHashDigestSize'</span></a></a><span> </span><span class="hs-special">(</span><a href="Crypto.Nettle.Hash.Types.html#KeyedHash"><span class="hs-identifier hs-var">KeyedHash</span></a><span> </span><a name="local-6989586621679028994"><a href="#local-6989586621679028994"><span class="hs-identifier">k</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#implKeyedHashDigestSize"><span class="hs-identifier hs-var">implKeyedHashDigestSize</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">witness</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679028994"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-163"></a><span class="hs-comment">{-|
Untagged variant of 'implKeyedHashName'; takes a (possible 'undefined') key typed value from a 'KeyedHashAlgorithm' instance as parameter.
-}</span><span>
</span><a name="line-166"></a><span class="hs-identifier">keyedHashName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#KeyedHashAlgorithm"><span class="hs-identifier hs-type">KeyedHashAlgorithm</span></a><span> </span><a href="#local-6989586621679028983"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679028983"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-167"></a><a name="keyedHashName"><a href="Crypto.Nettle.Hash.Types.html#keyedHashName"><span class="hs-identifier">keyedHashName</span></a></a><span> </span><a name="local-6989586621679028995"><a href="#local-6989586621679028995"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#implKeyedHashName"><span class="hs-identifier hs-var">implKeyedHashName</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">witness</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679028995"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-168"></a><span class="hs-comment">{-|
Get 'implKeyedHashName' from a 'KeyedHash'
-}</span><span>
</span><a name="line-171"></a><span class="hs-identifier">keyedHashName'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#KeyedHash"><span class="hs-identifier hs-type">KeyedHash</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-172"></a><a name="keyedHashName%27"><a href="Crypto.Nettle.Hash.Types.html#keyedHashName%27"><span class="hs-identifier">keyedHashName'</span></a></a><span> </span><span class="hs-special">(</span><a href="Crypto.Nettle.Hash.Types.html#KeyedHash"><span class="hs-identifier hs-var">KeyedHash</span></a><span> </span><a name="local-6989586621679028996"><a href="#local-6989586621679028996"><span class="hs-identifier">k</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#implKeyedHashName"><span class="hs-identifier hs-var">implKeyedHashName</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">witness</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679028996"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-173"></a><span class="hs-comment">{-|
Initialize a 'KeyedHash' context from a @key@
-}</span><span>
</span><a name="line-176"></a><span class="hs-identifier">keyedHashInit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#KeyedHashAlgorithm"><span class="hs-identifier hs-type">KeyedHashAlgorithm</span></a><span> </span><a href="#local-6989586621679028982"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-comment">{- ^ @key@ argument -}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Tagged</span><span> </span><a href="#local-6989586621679028982"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="Crypto.Nettle.Hash.Types.html#KeyedHash"><span class="hs-identifier hs-type">KeyedHash</span></a><span>
</span><a name="line-177"></a><a name="keyedHashInit"><a href="Crypto.Nettle.Hash.Types.html#keyedHashInit"><span class="hs-identifier">keyedHashInit</span></a></a><span> </span><a name="local-6989586621679028997"><a href="#local-6989586621679028997"><span class="hs-identifier">key</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#KeyedHash"><span class="hs-identifier hs-var">KeyedHash</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">tagSelf</span><span> </span><span class="hs-special">(</span><a href="Crypto.Nettle.Hash.Types.html#implKeyedHashInit"><span class="hs-identifier hs-var">implKeyedHashInit</span></a><span> </span><a href="#local-6989586621679028997"><span class="hs-identifier hs-var">key</span></a><span class="hs-special">)</span><span>
</span><a name="line-178"></a><span class="hs-comment">{-|
Untagged variant of 'keyedHashInit'; takes a (possible 'undefined') key typed value from a 'KeyedHashAlgorithm' instance as parameter.
-}</span><span>
</span><a name="line-181"></a><span class="hs-identifier">keyedHashInit'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#KeyedHashAlgorithm"><span class="hs-identifier hs-type">KeyedHashAlgorithm</span></a><span> </span><a href="#local-6989586621679028981"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679028981"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#KeyedHash"><span class="hs-identifier hs-type">KeyedHash</span></a><span>
</span><a name="line-182"></a><a name="keyedHashInit%27"><a href="Crypto.Nettle.Hash.Types.html#keyedHashInit%27"><span class="hs-identifier">keyedHashInit'</span></a></a><span> </span><a name="local-6989586621679028998"><a href="#local-6989586621679028998"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679028999"><a href="#local-6989586621679028999"><span class="hs-identifier">key</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#keyedHashInit"><span class="hs-identifier hs-var">keyedHashInit</span></a><span> </span><a href="#local-6989586621679028999"><span class="hs-identifier hs-var">key</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">witness</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679028998"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-183"></a><span class="hs-comment">{-|
Add more message data to the context
-}</span><span>
</span><a name="line-186"></a><span class="hs-identifier">keyedHashUpdate</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#KeyedHash"><span class="hs-identifier hs-type">KeyedHash</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#KeyedHash"><span class="hs-identifier hs-type">KeyedHash</span></a><span>
</span><a name="line-187"></a><a name="keyedHashUpdate"><a href="Crypto.Nettle.Hash.Types.html#keyedHashUpdate"><span class="hs-identifier">keyedHashUpdate</span></a></a><span> </span><span class="hs-special">(</span><a href="Crypto.Nettle.Hash.Types.html#KeyedHash"><span class="hs-identifier hs-var">KeyedHash</span></a><span> </span><a name="local-6989586621679029000"><a href="#local-6989586621679029000"><span class="hs-identifier">k</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#KeyedHash"><span class="hs-identifier hs-var">KeyedHash</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#implKeyedHashUpdate"><span class="hs-identifier hs-var">implKeyedHashUpdate</span></a><span> </span><a href="#local-6989586621679029000"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-188"></a><span class="hs-comment">{-|
Add more lazy message data to the context
-}</span><span>
</span><a name="line-191"></a><span class="hs-identifier">keyedHashUpdateLazy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#KeyedHash"><span class="hs-identifier hs-type">KeyedHash</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">L</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#KeyedHash"><span class="hs-identifier hs-type">KeyedHash</span></a><span>
</span><a name="line-192"></a><a name="keyedHashUpdateLazy"><a href="Crypto.Nettle.Hash.Types.html#keyedHashUpdateLazy"><span class="hs-identifier">keyedHashUpdateLazy</span></a></a><span> </span><span class="hs-special">(</span><a href="Crypto.Nettle.Hash.Types.html#KeyedHash"><span class="hs-identifier hs-var">KeyedHash</span></a><span> </span><a name="local-6989586621679029001"><a href="#local-6989586621679029001"><span class="hs-identifier">k</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#KeyedHash"><span class="hs-identifier hs-var">KeyedHash</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#implKeyedHashUpdateLazy"><span class="hs-identifier hs-var">implKeyedHashUpdateLazy</span></a><span> </span><a href="#local-6989586621679029001"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-193"></a><span class="hs-comment">{-|
Produce final digest
-}</span><span>
</span><a name="line-196"></a><span class="hs-identifier">keyedHashFinalize</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#KeyedHash"><span class="hs-identifier hs-type">KeyedHash</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-197"></a><a name="keyedHashFinalize"><a href="Crypto.Nettle.Hash.Types.html#keyedHashFinalize"><span class="hs-identifier">keyedHashFinalize</span></a></a><span> </span><span class="hs-special">(</span><a href="Crypto.Nettle.Hash.Types.html#KeyedHash"><span class="hs-identifier hs-var">KeyedHash</span></a><span> </span><a name="local-6989586621679029002"><a href="#local-6989586621679029002"><span class="hs-identifier">k</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#implKeyedHashFinalize"><span class="hs-identifier hs-var">implKeyedHashFinalize</span></a><span> </span><a href="#local-6989586621679029002"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-198"></a><span class="hs-comment">{-|
Helper to hash @key@ and @message@ in one step

Example:

&gt; untag (keyedHash (fromString &quot;secretkey&quot;) (fromString &quot;secret message&quot;) :: Tagged (HMAC SHA256) B.ByteString)
-}</span><span>
</span><a name="line-205"></a><span class="hs-identifier">keyedHash</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#KeyedHashAlgorithm"><span class="hs-identifier hs-type">KeyedHashAlgorithm</span></a><span> </span><a href="#local-6989586621679028980"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Tagged</span><span> </span><a href="#local-6989586621679028980"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-206"></a><a name="keyedHash"><a href="Crypto.Nettle.Hash.Types.html#keyedHash"><span class="hs-identifier">keyedHash</span></a></a><span> </span><a name="local-6989586621679029003"><a href="#local-6989586621679029003"><span class="hs-identifier">key</span></a></a><span> </span><a name="local-6989586621679029004"><a href="#local-6989586621679029004"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#keyedHashFinalize"><span class="hs-identifier hs-var">keyedHashFinalize</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#keyedHashUpdate"><span class="hs-identifier hs-var">keyedHashUpdate</span></a><span> </span><a href="#local-6989586621679029004"><span class="hs-identifier hs-var">msg</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#keyedHashInit"><span class="hs-identifier hs-var">keyedHashInit</span></a><span> </span><a href="#local-6989586621679029003"><span class="hs-identifier hs-var">key</span></a><span>
</span><a name="line-207"></a><span class="hs-comment">{-|
Untagged variant of 'keyedHash'; takes a (possible 'undefined') key typed value from a 'KeyedHashAlgorithm' instance as parameter.

Example:

&gt; keyedHash' (undefined :: HMAC SHA256) (fromString &quot;secretkey&quot;) (fromString &quot;secret message&quot;)
-}</span><span>
</span><a name="line-214"></a><span class="hs-identifier">keyedHash'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#KeyedHashAlgorithm"><span class="hs-identifier hs-type">KeyedHashAlgorithm</span></a><span> </span><a href="#local-6989586621679028979"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679028979"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-215"></a><a name="keyedHash%27"><a href="Crypto.Nettle.Hash.Types.html#keyedHash%27"><span class="hs-identifier">keyedHash'</span></a></a><span> </span><a name="local-6989586621679029005"><a href="#local-6989586621679029005"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679029006"><a href="#local-6989586621679029006"><span class="hs-identifier">key</span></a></a><span> </span><a name="local-6989586621679029007"><a href="#local-6989586621679029007"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#keyedHash"><span class="hs-identifier hs-var">keyedHash</span></a><span> </span><a href="#local-6989586621679029006"><span class="hs-identifier hs-var">key</span></a><span> </span><a href="#local-6989586621679029007"><span class="hs-identifier hs-var">msg</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">witness</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679029005"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-216"></a><span class="hs-comment">{-|
Helper to hash @key@ and lazy @message@ in one step

Example:

&gt; untag (keyedHashLazy (fromString &quot;secretkey&quot;) (fromString &quot;secret message&quot;) :: Tagged (HMAC SHA256) B.ByteString)
-}</span><span>
</span><a name="line-223"></a><span class="hs-identifier">keyedHashLazy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#KeyedHashAlgorithm"><span class="hs-identifier hs-type">KeyedHashAlgorithm</span></a><span> </span><a href="#local-6989586621679028978"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">L</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Tagged</span><span> </span><a href="#local-6989586621679028978"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-224"></a><a name="keyedHashLazy"><a href="Crypto.Nettle.Hash.Types.html#keyedHashLazy"><span class="hs-identifier">keyedHashLazy</span></a></a><span> </span><a name="local-6989586621679029008"><a href="#local-6989586621679029008"><span class="hs-identifier">key</span></a></a><span> </span><a name="local-6989586621679029009"><a href="#local-6989586621679029009"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#keyedHashFinalize"><span class="hs-identifier hs-var">keyedHashFinalize</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#keyedHashUpdateLazy"><span class="hs-identifier hs-var">keyedHashUpdateLazy</span></a><span> </span><a href="#local-6989586621679029009"><span class="hs-identifier hs-var">msg</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#keyedHashInit"><span class="hs-identifier hs-var">keyedHashInit</span></a><span> </span><a href="#local-6989586621679029008"><span class="hs-identifier hs-var">key</span></a><span>
</span><a name="line-225"></a><span class="hs-comment">{-|
Untagged variant of 'keyedHashLazy'; takes a (possible 'undefined') key typed value from a 'KeyedHashAlgorithm' instance as parameter.

Example:

&gt; keyedHashLazy' (undefined :: HMAC SHA256) (fromString &quot;secretkey&quot;) (fromString &quot;secret message&quot;)
-}</span><span>
</span><a name="line-232"></a><span class="hs-identifier">keyedHashLazy'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#KeyedHashAlgorithm"><span class="hs-identifier hs-type">KeyedHashAlgorithm</span></a><span> </span><a href="#local-6989586621679028977"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679028977"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">L</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-233"></a><a name="keyedHashLazy%27"><a href="Crypto.Nettle.Hash.Types.html#keyedHashLazy%27"><span class="hs-identifier">keyedHashLazy'</span></a></a><span> </span><a name="local-6989586621679029010"><a href="#local-6989586621679029010"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679029011"><a href="#local-6989586621679029011"><span class="hs-identifier">key</span></a></a><span> </span><a name="local-6989586621679029012"><a href="#local-6989586621679029012"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#keyedHashLazy"><span class="hs-identifier hs-var">keyedHashLazy</span></a><span> </span><a href="#local-6989586621679029011"><span class="hs-identifier hs-var">key</span></a><span> </span><a href="#local-6989586621679029012"><span class="hs-identifier hs-var">msg</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">witness</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679029010"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-234"></a><span>
</span><a name="line-235"></a><span class="hs-comment">{-|
'HMAC' is a generic 'KeyedHashAlgorithm' instance to calculate the 'HMAC' based
on a 'HashAlgorithm'
-}</span><span>
</span><a name="line-239"></a><span class="hs-keyword">data</span><span> </span><a name="HMAC"><a href="Crypto.Nettle.Hash.Types.html#HMAC"><span class="hs-identifier">HMAC</span></a></a><span> </span><a name="local-6989586621679021810"><a href="#local-6989586621679021810"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="HMAC"><a href="Crypto.Nettle.Hash.Types.html#HMAC"><span class="hs-identifier">HMAC</span></a></a><span> </span><span class="hs-glyph">!</span><a href="#local-6989586621679021810"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">!</span><a href="#local-6989586621679021810"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-240"></a><span>
</span><a name="line-241"></a><span class="hs-identifier">padZero</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-242"></a><a name="padZero"><a href="Crypto.Nettle.Hash.Types.html#padZero"><span class="hs-identifier">padZero</span></a></a><span> </span><a name="local-6989586621679029013"><a href="#local-6989586621679029013"><span class="hs-identifier">len</span></a></a><span> </span><a name="local-6989586621679029014"><a href="#local-6989586621679029014"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679029013"><span class="hs-identifier hs-var">len</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-identifier hs-var">B</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679029014"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">B</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">append</span><span> </span><a href="#local-6989586621679029014"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">B</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">replicate</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679029013"><span class="hs-identifier hs-var">len</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier hs-var">B</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679029014"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679029014"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-243"></a><span>
</span><a name="line-244"></a><span class="hs-keyword">instance</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a><span> </span><a href="#local-6989586621679025062"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#KeyedHashAlgorithm"><span class="hs-identifier hs-type">KeyedHashAlgorithm</span></a><span> </span><span class="hs-special">(</span><a href="Crypto.Nettle.Hash.Types.html#HMAC"><span class="hs-identifier hs-type">HMAC</span></a><span> </span><a href="#local-6989586621679025062"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-245"></a><span>	</span><span class="hs-identifier">implKeyedHashDigestSize</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-8214565720323796682"><a href="Crypto.Nettle.Hash.Types.html#implKeyedHashDigestSize"><span class="hs-identifier">rt</span></a></a><span> </span><span class="hs-identifier">hashDigestSize</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-246"></a><span>		</span><span class="hs-identifier">rt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">HashAlgorithm</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">Tagged</span></a><span> </span><a href="Crypto.Nettle.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679025064"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Tagged</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">HMAC</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">x</span><span>
</span><a name="line-247"></a><span>		</span><span class="hs-identifier">rt</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">retag</span><span>
</span><a name="line-248"></a><span>	</span><span class="hs-identifier">implKeyedHashName</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-8214565720323796683"><a href="Crypto.Nettle.Hash.Types.html#implKeyedHashName"><span class="hs-identifier">rt</span></a></a><span> </span><a name="local-8214565720323796683"><a href="Crypto.Nettle.Hash.Types.html#implKeyedHashName"><span class="hs-operator">$</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;HMAC-&quot;</span><span> </span><span class="hs-operator">++</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">hashName</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-249"></a><span>		</span><span class="hs-identifier">rt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">HashAlgorithm</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">Tagged</span></a><span> </span><a href="Crypto.Nettle.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679025067"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Tagged</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">HMAC</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">x</span><span>
</span><a name="line-250"></a><span>		</span><span class="hs-identifier">rt</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">retag</span><span>
</span><a name="line-251"></a><span>	</span><span class="hs-identifier">implKeyedHashInit</span><span> </span><a name="local-8214565720323796684"><a href="Crypto.Nettle.Hash.Types.html#implKeyedHashInit"><span class="hs-identifier">key</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">untag</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">tagSelf</span><span> </span><span class="hs-identifier">hashInit</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#hashInit"><span class="hs-operator hs-var">&gt;&gt;=</span></a><span> </span><span class="hs-glyph">\</span><a href="Crypto.Nettle.Hash.Types.html#hashInit"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-252"></a><span>		</span><span class="hs-identifier">blockSize</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">hashBlockSize</span><span>
</span><a name="line-253"></a><span>		</span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">key'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">padZero</span><span> </span><span class="hs-identifier">blockSize</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#padZero"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679025084"><span class="hs-identifier hs-var">B</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">length</span></a><span> </span><span class="hs-identifier">key</span><span> </span><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">blockSize</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679025084"><span class="hs-identifier hs-var">hash'</span></a><span> </span><a href="#local-6989586621679025084"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-identifier">key</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">key</span><span>
</span><a name="line-254"></a><span>		</span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">o_key</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">B</span><span class="hs-operator">.</span><span class="hs-identifier">map</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679028963"><a href="#local-6989586621679028963"><span class="hs-identifier">xor</span></a></a><span> </span><span class="hs-number">0x5c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">key'</span><span>
</span><a name="line-255"></a><span>		</span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">i_key</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">B</span><span class="hs-operator">.</span><span class="hs-identifier">map</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679028964"><a href="#local-6989586621679028964"><span class="hs-identifier">xor</span></a></a><span> </span><span class="hs-number">0x36</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">key'</span><span>
</span><a name="line-256"></a><span>		</span><span class="hs-identifier">return</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">HMAC</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">hashUpdate</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#HMAC"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-identifier">o_key</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">hashUpdate</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">i_key</span><span class="hs-special">)</span><span>
</span><a name="line-257"></a><span>	</span><span class="hs-identifier">implKeyedHashUpdate</span><span> </span><span class="hs-special">(</span><a name="local-8214565720323796685"><a href="Crypto.Nettle.Hash.Types.html#implKeyedHashUpdate"><span class="hs-identifier">HMAC</span></a></a><span> </span><span class="hs-identifier">o</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#HMAC"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">HMAC</span><span> </span><span class="hs-identifier">o</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#HMAC"><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-identifier">hashUpdate</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#hashUpdate"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-258"></a><span>	</span><span class="hs-identifier">implKeyedHashUpdateLazy</span><span> </span><span class="hs-special">(</span><a name="local-8214565720323796686"><a href="Crypto.Nettle.Hash.Types.html#implKeyedHashUpdateLazy"><span class="hs-identifier">HMAC</span></a></a><span> </span><span class="hs-identifier">o</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#HMAC"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">HMAC</span><span> </span><span class="hs-identifier">o</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#HMAC"><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-identifier">hashUpdateLazy</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#hashUpdateLazy"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-259"></a><span>	</span><span class="hs-identifier">implKeyedHashFinalize</span><span> </span><span class="hs-special">(</span><a name="local-8214565720323796687"><a href="Crypto.Nettle.Hash.Types.html#implKeyedHashFinalize"><span class="hs-identifier">HMAC</span></a></a><span> </span><span class="hs-identifier">o</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#HMAC"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">hashFinalize</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#hashFinalize"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-identifier">hashUpdate</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#hashUpdate"><span class="hs-identifier hs-var">o</span></a><span> </span><a href="Crypto.Nettle.Hash.Types.html#hashUpdate"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-identifier">hashFinalize</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#hashFinalize"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-260"></a><span>
</span><a name="line-261"></a><span class="hs-comment">{-|
'hmacInit' is the default implementation for 'hashHMAC' and initializes a 'KeyedHash' to calculate
the HMAC for a message with the given @key@.

Example:

&gt; let c = untag (hmacInit (fromString &quot;secretkey&quot;) :: Tagged SHA256 KeyedHash) in keyedHashFinalize $ keyedHashUpdate c (fromString &quot;secret message&quot;)
-}</span><span>
</span><a name="line-269"></a><span class="hs-identifier">hmacInit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a><span> </span><a href="#local-6989586621679028976"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-comment">{- ^ @key@ argument -}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Tagged</span><span> </span><a href="#local-6989586621679028976"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="Crypto.Nettle.Hash.Types.html#KeyedHash"><span class="hs-identifier hs-type">KeyedHash</span></a><span>
</span><a name="line-270"></a><a name="hmacInit"><a href="Crypto.Nettle.Hash.Types.html#hmacInit"><span class="hs-identifier">hmacInit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679029094"><span class="hs-identifier hs-var">rt</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#keyedHashInit"><span class="hs-identifier hs-var">keyedHashInit</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-271"></a><span>	</span><span class="hs-identifier">rt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HMAC</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#HMAC"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier hs-type">a</span><span> </span><span class="hs-identifier hs-type">x</span><span>
</span><a name="line-272"></a><span>	</span><span class="hs-identifier">rt</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">retag</span><span>
</span><a name="line-273"></a><span>
</span><a name="line-274"></a><span class="hs-comment">{-|
Untagged variant of 'hmacInit'; takes a (possible 'undefined') typed 'HashAlgorithm' context as parameter.

Example:

&gt; keyedHashFinalize $ flip keyedHashUpdate (fromString &quot;secret message&quot;) $ hmacInit' (undefined :: SHA256) (fromString &quot;secretkey&quot;)
-}</span><span>
</span><a name="line-281"></a><span class="hs-identifier">hmacInit'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a><span> </span><a href="#local-6989586621679028975"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679028975"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#KeyedHash"><span class="hs-identifier hs-type">KeyedHash</span></a><span>
</span><a name="line-282"></a><a name="hmacInit%27"><a href="Crypto.Nettle.Hash.Types.html#hmacInit%27"><span class="hs-identifier">hmacInit'</span></a></a><span> </span><a name="local-6989586621679029097"><a href="#local-6989586621679029097"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679029098"><a href="#local-6989586621679029098"><span class="hs-identifier">key</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#hmacInit"><span class="hs-identifier hs-var">hmacInit</span></a><span> </span><a href="#local-6989586621679029098"><span class="hs-identifier hs-var">key</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">witness</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679029097"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-283"></a><span>
</span><a name="line-284"></a><span class="hs-comment">{-|
calculate HMAC with a 'HashAlgorithm' for a @key@ and @message@

Example:

&gt; untag (hmac (fromString &quot;secretkey&quot;) (fromString &quot;secret message&quot;) :: Tagged SHA256 B.ByteString)
-}</span><span>
</span><a name="line-291"></a><span class="hs-identifier">hmac</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a><span> </span><a href="#local-6989586621679028974"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-comment">{- ^ @key@ argument -}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-comment">{- ^ @message@ argument -}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Tagged</span><span> </span><a href="#local-6989586621679028974"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-292"></a><a name="hmac"><a href="Crypto.Nettle.Hash.Types.html#hmac"><span class="hs-identifier">hmac</span></a></a><span> </span><a name="local-6989586621679029099"><a href="#local-6989586621679029099"><span class="hs-identifier">key</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679029100"><span class="hs-identifier hs-var">rt</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#keyedHash"><span class="hs-identifier hs-var">keyedHash</span></a><span> </span><a href="#local-6989586621679029099"><span class="hs-identifier hs-var">key</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-293"></a><span>	</span><span class="hs-identifier">rt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HMAC</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#HMAC"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier hs-type">a</span><span> </span><span class="hs-identifier hs-type">x</span><span>
</span><a name="line-294"></a><span>	</span><span class="hs-identifier">rt</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">retag</span><span>
</span><a name="line-295"></a><span>
</span><a name="line-296"></a><span class="hs-comment">{-|
Untagged variant of 'hmac'; takes a (possible 'undefined') typed 'HashAlgorithm' context as parameter.

Example:

&gt; hmac' (undefined :: SHA256) (fromString &quot;secretkey&quot;) (fromString &quot;secret message&quot;)
-}</span><span>
</span><a name="line-303"></a><span class="hs-identifier">hmac'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a><span> </span><a href="#local-6989586621679028973"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679028973"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-304"></a><a name="hmac%27"><a href="Crypto.Nettle.Hash.Types.html#hmac%27"><span class="hs-identifier">hmac'</span></a></a><span> </span><a name="local-6989586621679029103"><a href="#local-6989586621679029103"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679029104"><a href="#local-6989586621679029104"><span class="hs-identifier">key</span></a></a><span> </span><a name="local-6989586621679029105"><a href="#local-6989586621679029105"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#hmac"><span class="hs-identifier hs-var">hmac</span></a><span> </span><a href="#local-6989586621679029104"><span class="hs-identifier hs-var">key</span></a><span> </span><a href="#local-6989586621679029105"><span class="hs-identifier hs-var">msg</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">witness</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679029103"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-305"></a><span>
</span><a name="line-306"></a><span class="hs-comment">{-|
calculate HMAC with a 'HashAlgorithm' for a @key@ and lazy @message@

Example:

&gt; untag (hmacLazy (fromString &quot;secretkey&quot;) (fromString &quot;secret message&quot;) :: Tagged SHA256 B.ByteString)
-}</span><span>
</span><a name="line-313"></a><span class="hs-identifier">hmacLazy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a><span> </span><a href="#local-6989586621679028972"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-comment">{- ^ @key@ argument -}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">L</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-comment">{- ^ @message@ argument -}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Tagged</span><span> </span><a href="#local-6989586621679028972"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-314"></a><a name="hmacLazy"><a href="Crypto.Nettle.Hash.Types.html#hmacLazy"><span class="hs-identifier">hmacLazy</span></a></a><span> </span><a name="local-6989586621679029106"><a href="#local-6989586621679029106"><span class="hs-identifier">key</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679029107"><span class="hs-identifier hs-var">rt</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#keyedHashLazy"><span class="hs-identifier hs-var">keyedHashLazy</span></a><span> </span><a href="#local-6989586621679029106"><span class="hs-identifier hs-var">key</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-315"></a><span>	</span><span class="hs-identifier">rt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HMAC</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#HMAC"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Tagged</span><span> </span><span class="hs-identifier hs-type">a</span><span> </span><span class="hs-identifier hs-type">x</span><span>
</span><a name="line-316"></a><span>	</span><span class="hs-identifier">rt</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">retag</span><span>
</span><a name="line-317"></a><span>
</span><a name="line-318"></a><span class="hs-comment">{-|
Untagged variant of 'hmacLazy'; takes a (possible 'undefined') typed 'HashAlgorithm' context as parameter.

Example:

&gt; hmacLazy' (undefined :: SHA256) (fromString &quot;secretkey&quot;) (fromString &quot;secret message&quot;)
-}</span><span>
</span><a name="line-325"></a><span class="hs-identifier">hmacLazy'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a><span> </span><a href="#local-6989586621679028971"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679028971"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">L</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">B</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-326"></a><a name="hmacLazy%27"><a href="Crypto.Nettle.Hash.Types.html#hmacLazy%27"><span class="hs-identifier">hmacLazy'</span></a></a><span> </span><a name="local-6989586621679029110"><a href="#local-6989586621679029110"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679029111"><a href="#local-6989586621679029111"><span class="hs-identifier">key</span></a></a><span> </span><a name="local-6989586621679029112"><a href="#local-6989586621679029112"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Nettle.Hash.Types.html#hmacLazy"><span class="hs-identifier hs-var">hmacLazy</span></a><span> </span><a href="#local-6989586621679029111"><span class="hs-identifier hs-var">key</span></a><span> </span><a href="#local-6989586621679029112"><span class="hs-identifier hs-var">msg</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">witness</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679029110"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-327"></a></pre></body></html>